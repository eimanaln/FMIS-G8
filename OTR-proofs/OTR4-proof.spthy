theory OTR4 begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman
functions: fst/1, h/1, mac/2, pair/2, pk/1, sign/2, snd/1, true/0,
           verify/3
equations:
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(k, m, mac(m, k)) = true,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true











rule (modulo E) Generate_key_pair:
   [ Fr( ~sk ) ]
  --[ Gen( ) ]->
   [ !Ltk( $A, ~sk ), !Pk( $A, pk(~sk) ), Out( pk(~sk) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_secret_key:
   [ !Ltk( A, sk ) ] --[ Reveal( A ) ]-> [ Out( sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Init_A:
   [ Fr( ~idA ), !Ltk( A, ka ), !Pk( B, pkb ) ]
  --[ Init( 'I', A, ~idA ), InitI( ) ]->
   [ St_A_1( A, B, ~idA, ka, pkb ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Init_B:
   [ Fr( ~idB ), !Ltk( B, kb ), !Pk( A, pka ) ]
  --[ Init( 'R', B, ~idB ), InitR( ) ]->
   [ St_B_1( A, B, ~idB, pka, kb ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) A_1_send:
   [ St_A_1( A, B, idA, ka, pkb ), Fr( ~x ) ]
  -->
   [ St_A_2( A, B, idA, ka, pkb, ~x ), Out( 'g'^~x ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) B_1_recv[derivchecks]:
   [ St_B_1( A, B, idB, pka, kb ), In( 'g'^x ) ]
  --[ Neq( 'g'^x, 'g' ) ]->
   [ St_B_2( A, B, idB, pka, kb, 'g'^x ) ]

  /*
  rule (modulo AC) B_1_recv[derivchecks]:
     [ St_B_1( A, B, idB, pka, kb ), In( z ) ]
    --[ Neq( z, 'g' ) ]->
     [ St_B_2( A, B, idB, pka, kb, z ) ]
    variants (modulo AC)
    1. z     = 'g'
    
    2. z     = 'g'^x.9
  */

rule (modulo E) B_2_send:
   [ St_B_2( A, B, idB, pka, kb, gx ), Fr( ~y ) ]
  --[
  Running( B, A, <'I', 'R', h(gx^~y)> ),
  Finish( B, A, 'R', gx, 'g'^~y, h(gx^~y) )
  ]->
   [ St_B_3( A, B, idB, pka, kb, gx, ~y, h(gx^~y) ), Out( 'g'^~y ) ]

  /*
  rule (modulo AC) B_2_send:
     [ St_B_2( A, B, idB, pka, kb, gx ), Fr( ~y ) ]
    --[
    Running( B, A, <'I', 'R', h(z)> ),
    Finish( B, A, 'R', gx, 'g'^~y, h(z) )
    ]->
     [ St_B_3( A, B, idB, pka, kb, gx, ~y, h(z) ), Out( 'g'^~y ) ]
    variants (modulo AC)
    1. ~y    = ~y.13
       gx    = gx.16
       z     = gx.16^~y.13
    
    2. ~y    = ~y.17
       gx    = z.24^inv(~y.17)
       z     = z.24
    
    3. ~y    = ~y.77
       gx    = x.151^x.152
       z     = x.151^(~y.77*x.152)
    
    4. ~y    = ~y.80
       gx    = x.157^inv((~y.80*x.158))
       z     = x.157^inv(x.158)
    
    5. ~y    = ~y.80
       gx    = x.157^(x.158*inv(~y.80))
       z     = x.157^x.158
    
    6. ~y    = ~y.81
       gx    = x.158^(x.159*inv((~y.81*x.160)))
       z     = x.158^(x.159*inv(x.160))
    
    7. gx    = DH_neutral
       z     = DH_neutral
  */

rule (modulo E) A_2_recv[derivchecks]:
   [ St_A_2( A, B, idA, ka, pkb, x ), In( 'g'^y ) ]
  --[ Running( A, B, <'R', 'I', h('g'^y^x)> ), Neq( 'g'^y, 'g' ) ]->
   [ St_A_3( A, B, idA, ka, pkb, x, 'g'^y, h('g'^y^x) ) ]

  /*
  rule (modulo AC) A_2_recv[derivchecks]:
     [ St_A_2( A, B, idA, ka, pkb, x ), In( z ) ]
    --[ Running( A, B, <'R', 'I', h(z.1)> ), Neq( z, 'g' ) ]->
     [ St_A_3( A, B, idA, ka, pkb, x, z, h(z.1) ) ]
    variants (modulo AC)
     1. x     = x.11
        z     = 'g'
        z.1   = 'g'^x.11
    
     2. x     = x.11
        z     = 'g'^inv(x.11)
        z.1   = 'g'
    
     3. x     = x.25
        z     = 'g'^y.43
        z.1   = 'g'^(x.25*y.43)
    
     4. x     = x.26
        z     = 'g'^inv((x.26*x.45))
        z.1   = 'g'^inv(x.45)
    
     5. x     = x.26
        z     = 'g'^(x.45*inv(x.26))
        z.1   = 'g'^x.45
    
     6. x     = x.27
        z     = 'g'^(x.46*inv((x.27*x.47)))
        z.1   = 'g'^(x.46*inv(x.47))
    
     7. x     = inv(x.11)
        z     = 'g'^x.11
        z.1   = 'g'
    
     8. x     = inv(x.12)
        z     = 'g'^inv(x.13)
        z.1   = 'g'^inv((x.12*x.13))
    
     9. x     = inv(x.12)
        z     = 'g'^(x.12*x.13)
        z.1   = 'g'^x.13
    
    10. x     = inv(x.13)
        z     = 'g'^(x.14*inv(x.15))
        z.1   = 'g'^(x.14*inv((x.13*x.15)))
    
    11. x     = inv((x.12*x.13))
        z     = 'g'^x.13
        z.1   = 'g'^inv(x.12)
    
    12. x     = inv((x.13*x.14))
        z     = 'g'^(x.13*x.15)
        z.1   = 'g'^(x.15*inv(x.14))
    
    13. x     = inv((x.13*x.14))
        z     = 'g'^(x.13*inv(x.15))
        z.1   = 'g'^inv((x.14*x.15))
    
    14. x     = inv((x.14*x.15))
        z     = 'g'^(x.14*x.16*inv(x.17))
        z.1   = 'g'^(x.16*inv((x.15*x.17)))
    
    15. x     = one
        z     = 'g'
        z.1   = 'g'
    
    16. x     = one
        z     = 'g'^y.11
        z.1   = 'g'^y.11
    
    17. x     = (x.12*x.13)
        z     = 'g'^inv(x.12)
        z.1   = 'g'^x.13
    
    18. x     = (x.12*inv(x.13))
        z     = 'g'^x.13
        z.1   = 'g'^x.12
    
    19. x     = (x.12*inv(x.13))
        z     = 'g'^(x.13*inv(x.12))
        z.1   = 'g'
    
    20. x     = (x.13*x.14)
        z     = 'g'^inv((x.13*x.15))
        z.1   = 'g'^(x.14*inv(x.15))
    
    21. x     = (x.13*x.14)
        z     = 'g'^(x.15*inv(x.13))
        z.1   = 'g'^(x.14*x.15)
    
    22. x     = (x.13*x.14*inv(x.15))
        z     = 'g'^(x.15*inv(x.14))
        z.1   = 'g'^x.13
    
    23. x     = (x.13*inv(x.14))
        z     = 'g'^inv(x.15)
        z.1   = 'g'^(x.13*inv((x.14*x.15)))
    
    24. x     = (x.13*inv(x.14))
        z     = 'g'^inv((x.13*x.15))
        z.1   = 'g'^inv((x.14*x.15))
    
    25. x     = (x.13*inv(x.14))
        z     = 'g'^(x.14*x.15)
        z.1   = 'g'^(x.13*x.15)
    
    26. x     = (x.13*inv(x.14))
        z     = 'g'^(x.14*x.15*inv(x.13))
        z.1   = 'g'^x.15
    
    27. x     = (x.13*inv(x.14))
        z     = 'g'^(x.14*inv((x.13*x.15)))
        z.1   = 'g'^inv(x.15)
    
    28. x     = (x.13*inv((x.14*x.15)))
        z     = 'g'^x.15
        z.1   = 'g'^(x.13*inv(x.14))
    
    29. x     = (x.13*inv((x.14*x.15)))
        z     = 'g'^(x.15*inv(x.13))
        z.1   = 'g'^inv(x.14)
    
    30. x     = (x.14*x.15)
        z     = 'g'^(x.16*inv((x.14*x.17)))
        z.1   = 'g'^(x.15*x.16*inv(x.17))
    
    31. x     = (x.14*x.15*inv(x.16))
        z     = 'g'^inv((x.15*x.17))
        z.1   = 'g'^(x.14*inv((x.16*x.17)))
    
    32. x     = (x.14*x.15*inv(x.16))
        z     = 'g'^(x.16*x.17*inv(x.14))
        z.1   = 'g'^(x.15*x.17)
    
    33. x     = (x.14*x.15*inv(x.16))
        z     = 'g'^(x.16*inv((x.14*x.17)))
        z.1   = 'g'^(x.15*inv(x.17))
    
    34. x     = (x.14*x.15*inv((x.16*x.17)))
        z     = 'g'^(x.17*inv(x.15))
        z.1   = 'g'^(x.14*inv(x.16))
    
    35. x     = (x.14*inv(x.15))
        z     = 'g'^(x.15*x.16*inv((x.14*x.17)))
        z.1   = 'g'^(x.16*inv(x.17))
    
    36. x     = (x.14*inv(x.15))
        z     = 'g'^(x.16*inv(x.17))
        z.1   = 'g'^(x.14*x.16*inv((x.15*x.17)))
    
    37. x     = (x.14*inv(x.15))
        z     = 'g'^(x.16*inv((x.14*x.17)))
        z.1   = 'g'^(x.16*inv((x.15*x.17)))
    
    38. x     = (x.14*inv((x.15*x.16)))
        z     = 'g'^(x.15*x.17)
        z.1   = 'g'^(x.14*x.17*inv(x.16))
    
    39. x     = (x.14*inv((x.15*x.16)))
        z     = 'g'^(x.15*x.17*inv(x.14))
        z.1   = 'g'^(x.17*inv(x.16))
    
    40. x     = (x.14*inv((x.15*x.16)))
        z     = 'g'^(x.15*inv(x.17))
        z.1   = 'g'^(x.14*inv((x.16*x.17)))
    
    41. x     = (x.14*inv((x.15*x.16)))
        z     = 'g'^(x.15*inv((x.14*x.17)))
        z.1   = 'g'^inv((x.16*x.17))
    
    42. x     = (x.15*x.16*inv(x.17))
        z     = 'g'^(x.17*x.18*inv((x.15*x.19)))
        z.1   = 'g'^(x.16*x.18*inv(x.19))
    
    43. x     = (x.15*x.16*inv(x.17))
        z     = 'g'^(x.18*inv((x.15*x.19)))
        z.1   = 'g'^(x.16*x.18*inv((x.17*x.19)))
    
    44. x     = (x.15*x.16*inv((x.17*x.18)))
        z     = 'g'^(x.17*x.19*inv(x.15))
        z.1   = 'g'^(x.16*x.19*inv(x.18))
    
    45. x     = (x.15*x.16*inv((x.17*x.18)))
        z     = 'g'^(x.17*inv((x.15*x.19)))
        z.1   = 'g'^(x.16*inv((x.18*x.19)))
    
    46. x     = (x.15*inv((x.16*x.17)))
        z     = 'g'^(x.16*x.18*inv(x.19))
        z.1   = 'g'^(x.15*x.18*inv((x.17*x.19)))
    
    47. x     = (x.15*inv((x.16*x.17)))
        z     = 'g'^(x.16*x.18*inv((x.15*x.19)))
        z.1   = 'g'^(x.18*inv((x.17*x.19)))
    
    48. x     = (x.16*x.17*inv((x.18*x.19)))
        z     = 'g'^(x.18*x.20*inv((x.16*x.21)))
        z.1   = 'g'^(x.17*x.20*inv((x.19*x.21)))
  */

rule (modulo E) A_3_send:
   [ St_A_3( A, B, idA, ka, pkb, x, gy, h(gy^x) ) ]
  -->
   [
   St_A_4( A, B, idA, ka, pkb, x, gy, h(gy^x) ),
   Out( <A, sign(<gy, 'g'^x>, ka), mac(<'0', A>, h(gy^x)), pk(ka)> )
   ]

  /*
  rule (modulo AC) A_3_send:
     [ St_A_3( A, B, idA, ka, pkb, x, gy, h(z) ) ]
    -->
     [
     St_A_4( A, B, idA, ka, pkb, x, gy, h(z) ),
     Out( <A, sign(<gy, z.1>, ka), mac(<'0', A>, h(z)), pk(ka)> )
     ]
    variants (modulo AC)
     1. gy    = gy.11
        x     = x.15
        z     = gy.11^x.15
        z.1   = 'g'^x.15
    
     2. gy    = gy.11
        x     = one
        z     = gy.11
        z.1   = 'g'
    
     3. gy    = DH_neutral
        x     = x.11
        z     = DH_neutral
        z.1   = 'g'^x.11
    
     4. gy    = z.12^x.15
        x     = inv(x.15)
        z     = z.12
        z.1   = 'g'^inv(x.15)
    
     5. gy    = x.13^(x.14*x.15)
        x     = inv(x.14)
        z     = x.13^x.15
        z.1   = 'g'^inv(x.14)
    
     6. gy    = z.13^inv(x.12)
        x     = x.12
        z     = z.13
        z.1   = 'g'^x.12
    
     7. gy    = z.13^(x.16*inv(x.17))
        x     = (x.17*inv(x.16))
        z     = z.13
        z.1   = 'g'^(x.17*inv(x.16))
    
     8. gy    = x.14^(x.15*x.16*inv(x.17))
        x     = (x.17*inv(x.16))
        z     = x.14^x.15
        z.1   = 'g'^(x.17*inv(x.16))
    
     9. gy    = x.14^(x.15*inv((x.16*x.17)))
        x     = (x.17*inv(x.15))
        z     = x.14^inv(x.16)
        z.1   = 'g'^(x.17*inv(x.15))
    
    10. gy    = x.15^(x.16*x.17*inv((x.18*x.19)))
        x     = (x.19*inv(x.17))
        z     = x.15^(x.16*inv(x.18))
        z.1   = 'g'^(x.19*inv(x.17))
    
    11. gy    = x.16^x.17
        x     = x.13
        z     = x.16^(x.13*x.17)
        z.1   = 'g'^x.13
    
    12. gy    = x.16^x.17
        x     = inv((x.17*x.21))
        z     = x.16^inv(x.21)
        z.1   = 'g'^inv((x.17*x.21))
    
    13. gy    = x.16^x.17
        x     = (x.21*inv(x.17))
        z     = x.16^x.21
        z.1   = 'g'^(x.21*inv(x.17))
    
    14. gy    = x.16^inv(x.17)
        x     = inv(x.21)
        z     = x.16^inv((x.17*x.21))
        z.1   = 'g'^inv(x.21)
    
    15. gy    = x.16^inv(x.17)
        x     = (x.17*x.21)
        z     = x.16^x.21
        z.1   = 'g'^(x.17*x.21)
    
    16. gy    = x.16^inv((x.13*x.17))
        x     = x.13
        z     = x.16^inv(x.17)
        z.1   = 'g'^x.13
    
    17. gy    = x.16^(x.17*inv(x.13))
        x     = x.13
        z     = x.16^x.17
        z.1   = 'g'^x.13
    
    18. gy    = x.17^x.18
        x     = (x.22*inv((x.18*x.23)))
        z     = x.17^(x.22*inv(x.23))
        z.1   = 'g'^(x.22*inv((x.18*x.23)))
    
    19. gy    = x.17^inv(x.18)
        x     = (x.22*inv(x.23))
        z     = x.17^(x.22*inv((x.18*x.23)))
        z.1   = 'g'^(x.22*inv(x.23))
    
    20. gy    = x.17^inv((x.18*x.19))
        x     = (x.18*x.23)
        z     = x.17^(x.23*inv(x.19))
        z.1   = 'g'^(x.18*x.23)
    
    21. gy    = x.17^inv((x.18*x.19))
        x     = (x.18*inv(x.23))
        z     = x.17^inv((x.19*x.23))
        z.1   = 'g'^(x.18*inv(x.23))
    
    22. gy    = x.17^(x.18*x.19)
        x     = inv((x.18*x.23))
        z     = x.17^(x.19*inv(x.23))
        z.1   = 'g'^inv((x.18*x.23))
    
    23. gy    = x.17^(x.18*x.19)
        x     = (x.23*inv(x.18))
        z     = x.17^(x.19*x.23)
        z.1   = 'g'^(x.23*inv(x.18))
    
    24. gy    = x.17^(x.18*inv(x.19))
        x     = inv(x.23)
        z     = x.17^(x.18*inv((x.19*x.23)))
        z.1   = 'g'^inv(x.23)
    
    25. gy    = x.17^(x.18*inv(x.19))
        x     = inv((x.18*x.23))
        z     = x.17^inv((x.19*x.23))
        z.1   = 'g'^inv((x.18*x.23))
    
    26. gy    = x.17^(x.18*inv(x.19))
        x     = (x.19*x.23)
        z     = x.17^(x.18*x.23)
        z.1   = 'g'^(x.19*x.23)
    
    27. gy    = x.17^(x.18*inv(x.19))
        x     = (x.19*x.23*inv(x.18))
        z     = x.17^x.23
        z.1   = 'g'^(x.19*x.23*inv(x.18))
    
    28. gy    = x.17^(x.18*inv(x.19))
        x     = (x.19*inv((x.18*x.23)))
        z     = x.17^inv(x.23)
        z.1   = 'g'^(x.19*inv((x.18*x.23)))
    
    29. gy    = x.17^(x.18*inv((x.14*x.19)))
        x     = x.14
        z     = x.17^(x.18*inv(x.19))
        z.1   = 'g'^x.14
    
    30. gy    = x.18^inv((x.19*x.20))
        x     = (x.19*x.24*inv(x.25))
        z     = x.18^(x.24*inv((x.20*x.25)))
        z.1   = 'g'^(x.19*x.24*inv(x.25))
    
    31. gy    = x.18^(x.19*x.20)
        x     = (x.24*inv((x.19*x.25)))
        z     = x.18^(x.20*x.24*inv(x.25))
        z.1   = 'g'^(x.24*inv((x.19*x.25)))
    
    32. gy    = x.18^(x.19*x.20*inv(x.21))
        x     = inv((x.20*x.25))
        z     = x.18^(x.19*inv((x.21*x.25)))
        z.1   = 'g'^inv((x.20*x.25))
    
    33. gy    = x.18^(x.19*x.20*inv(x.21))
        x     = (x.21*x.25*inv(x.19))
        z     = x.18^(x.20*x.25)
        z.1   = 'g'^(x.21*x.25*inv(x.19))
    
    34. gy    = x.18^(x.19*x.20*inv(x.21))
        x     = (x.21*inv((x.19*x.25)))
        z     = x.18^(x.20*inv(x.25))
        z.1   = 'g'^(x.21*inv((x.19*x.25)))
    
    35. gy    = x.18^(x.19*inv(x.20))
        x     = (x.20*x.24*inv((x.19*x.25)))
        z     = x.18^(x.24*inv(x.25))
        z.1   = 'g'^(x.20*x.24*inv((x.19*x.25)))
    
    36. gy    = x.18^(x.19*inv(x.20))
        x     = (x.24*inv(x.25))
        z     = x.18^(x.19*x.24*inv((x.20*x.25)))
        z.1   = 'g'^(x.24*inv(x.25))
    
    37. gy    = x.18^(x.19*inv(x.20))
        x     = (x.24*inv((x.19*x.25)))
        z     = x.18^(x.24*inv((x.20*x.25)))
        z.1   = 'g'^(x.24*inv((x.19*x.25)))
    
    38. gy    = x.18^(x.19*inv((x.20*x.21)))
        x     = (x.20*x.25)
        z     = x.18^(x.19*x.25*inv(x.21))
        z.1   = 'g'^(x.20*x.25)
    
    39. gy    = x.18^(x.19*inv((x.20*x.21)))
        x     = (x.20*x.25*inv(x.19))
        z     = x.18^(x.25*inv(x.21))
        z.1   = 'g'^(x.20*x.25*inv(x.19))
    
    40. gy    = x.18^(x.19*inv((x.20*x.21)))
        x     = (x.20*inv(x.25))
        z     = x.18^(x.19*inv((x.21*x.25)))
        z.1   = 'g'^(x.20*inv(x.25))
    
    41. gy    = x.18^(x.19*inv((x.20*x.21)))
        x     = (x.20*inv((x.19*x.25)))
        z     = x.18^inv((x.21*x.25))
        z.1   = 'g'^(x.20*inv((x.19*x.25)))
    
    42. gy    = x.19^(x.20*x.21*inv(x.22))
        x     = (x.22*x.26*inv((x.20*x.27)))
        z     = x.19^(x.21*x.26*inv(x.27))
        z.1   = 'g'^(x.22*x.26*inv((x.20*x.27)))
    
    43. gy    = x.19^(x.20*x.21*inv(x.22))
        x     = (x.26*inv((x.20*x.27)))
        z     = x.19^(x.21*x.26*inv((x.22*x.27)))
        z.1   = 'g'^(x.26*inv((x.20*x.27)))
    
    44. gy    = x.19^(x.20*x.21*inv((x.22*x.23)))
        x     = (x.22*x.27*inv(x.20))
        z     = x.19^(x.21*x.27*inv(x.23))
        z.1   = 'g'^(x.22*x.27*inv(x.20))
    
    45. gy    = x.19^(x.20*x.21*inv((x.22*x.23)))
        x     = (x.22*inv((x.20*x.27)))
        z     = x.19^(x.21*inv((x.23*x.27)))
        z.1   = 'g'^(x.22*inv((x.20*x.27)))
    
    46. gy    = x.19^(x.20*inv((x.21*x.22)))
        x     = (x.21*x.26*inv(x.27))
        z     = x.19^(x.20*x.26*inv((x.22*x.27)))
        z.1   = 'g'^(x.21*x.26*inv(x.27))
    
    47. gy    = x.19^(x.20*inv((x.21*x.22)))
        x     = (x.21*x.26*inv((x.20*x.27)))
        z     = x.19^(x.26*inv((x.22*x.27)))
        z.1   = 'g'^(x.21*x.26*inv((x.20*x.27)))
    
    48. gy    = x.20^(x.21*x.22*inv((x.23*x.24)))
        x     = (x.23*x.28*inv((x.21*x.29)))
        z     = x.20^(x.22*x.28*inv((x.24*x.29)))
        z.1   = 'g'^(x.23*x.28*inv((x.21*x.29)))
  */

rule (modulo E) B_3_recv:
   [
   St_B_3( A, B, idB, pka, kb, gx, y, h(gx^y) ),
   In( <A, signa, mac(<'0', A>, h(gx^y)), pka> )
   ]
  --[
  Eq( verify(signa, <'g'^y, gx>, pka), true ),
  Commit( B, A, <'R', 'I', h(gx^y)> ), Secret( A, B, h(gx^y) ),
  Finish( B, A, 'R', gx, 'g'^y, h(gx^y) )
  ]->
   [ St_B_4( A, B, idB, pka, kb, gx, y, h(gx^y) ) ]

  /*
  rule (modulo AC) B_3_recv:
     [
     St_B_3( A, B, idB, pka, kb, gx, y, h(z) ),
     In( <A, signa, mac(<'0', A>, h(z)), pka> )
     ]
    --[
    Eq( z.1, true ), Commit( B, A, <'R', 'I', h(z)> ),
    Secret( A, B, h(z) ), Finish( B, A, 'R', gx, z.2, h(z) )
    ]->
     [ St_B_4( A, B, idB, pka, kb, gx, y, h(z) ) ]
    variants (modulo AC)
      1. gx    = gx.20
         pka   = pka.23
         signa = signa.24
         y     = one
         z     = gx.20
         z.1   = verify(signa.24, <'g', gx.20>, pka.23)
         z.2   = 'g'
    
      2. gx    = gx.20
         pka   = mac(<'g', gx.20>, signa.24)
         signa = signa.24
         y     = one
         z     = gx.20
         z.1   = true
         z.2   = 'g'
    
      3. gx    = gx.21
         pka   = pka.24
         signa = signa.25
         y     = y.26
         z     = gx.21^y.26
         z.1   = verify(signa.25, <'g'^y.26, gx.21>, pka.24)
         z.2   = 'g'^y.26
    
      4. gx    = gx.21
         pka   = mac(<'g'^y.26, gx.21>, signa.25)
         signa = signa.25
         y     = y.26
         z     = gx.21^y.26
         z.1   = true
         z.2   = 'g'^y.26
    
      5. gx    = gx.43
         pka   = pk(x.82)
         signa = sign(<'g', gx.43>, x.82)
         y     = one
         z     = gx.43
         z.1   = true
         z.2   = 'g'
    
      6. gx    = gx.43
         pka   = pk(x.82)
         signa = sign(<'g'^y.48, gx.43>, x.82)
         y     = y.48
         z     = gx.43^y.48
         z.1   = true
         z.2   = 'g'^y.48
    
      7. gx    = DH_neutral
         pka   = pka.18
         signa = signa.19
         y     = y.20
         z     = DH_neutral
         z.1   = verify(signa.19, <'g'^y.20, DH_neutral>, pka.18)
         z.2   = 'g'^y.20
    
      8. gx    = DH_neutral
         pka   = mac(<'g'^y.18, DH_neutral>, signa.17)
         signa = signa.17
         y     = y.18
         z     = DH_neutral
         z.1   = true
         z.2   = 'g'^y.18
    
      9. gx    = DH_neutral
         pka   = pk(x.51)
         signa = sign(<'g'^y.30, DH_neutral>, x.51)
         y     = y.30
         z     = DH_neutral
         z.1   = true
         z.2   = 'g'^y.30
    
     10. gx    = z.20^inv(y.19)
         pka   = mac(<'g'^y.19, z.20^inv(y.19)>, signa.18)
         signa = signa.18
         y     = y.19
         z     = z.20
         z.1   = true
         z.2   = 'g'^y.19
    
     11. gx    = x.21^x.22
         pka   = pk(x.25)
         signa = sign(<'g'^inv((x.22*x.26)), x.21^x.22>, x.25)
         y     = inv((x.22*x.26))
         z     = x.21^inv(x.26)
         z.1   = true
         z.2   = 'g'^inv((x.22*x.26))
    
     12. gx    = x.21^x.22
         pka   = pk(x.25)
         signa = sign(<'g'^(x.26*inv(x.22)), x.21^x.22>, x.25)
         y     = (x.26*inv(x.22))
         z     = x.21^x.26
         z.1   = true
         z.2   = 'g'^(x.26*inv(x.22))
    
     13. gx    = x.21^inv(x.22)
         pka   = pk(x.25)
         signa = sign(<'g'^inv(x.26), x.21^inv(x.22)>, x.25)
         y     = inv(x.26)
         z     = x.21^inv((x.22*x.26))
         z.1   = true
         z.2   = 'g'^inv(x.26)
    
     14. gx    = x.21^inv(x.22)
         pka   = pk(x.25)
         signa = sign(<'g'^(x.22*x.26), x.21^inv(x.22)>, x.25)
         y     = (x.22*x.26)
         z     = x.21^x.26
         z.1   = true
         z.2   = 'g'^(x.22*x.26)
    
     15. gx    = x.21^(x.22*x.23)
         pka   = pk(x.26)
         signa = sign(<'g'^inv(x.22), x.21^(x.22*x.23)>, x.26)
         y     = inv(x.22)
         z     = x.21^x.23
         z.1   = true
         z.2   = 'g'^inv(x.22)
    
     16. gx    = x.22^x.23
         pka   = pk(x.26)
         signa = sign(<'g'^(x.27*inv((x.23*x.28))), x.22^x.23>, x.26)
         y     = (x.27*inv((x.23*x.28)))
         z     = x.22^(x.27*inv(x.28))
         z.1   = true
         z.2   = 'g'^(x.27*inv((x.23*x.28)))
    
     17. gx    = x.22^inv(x.23)
         pka   = pk(x.26)
         signa = sign(<'g'^(x.27*inv(x.28)), x.22^inv(x.23)>, x.26)
         y     = (x.27*inv(x.28))
         z     = x.22^(x.27*inv((x.23*x.28)))
         z.1   = true
         z.2   = 'g'^(x.27*inv(x.28))
    
     18. gx    = x.22^inv((x.23*x.24))
         pka   = pk(x.27)
         signa = sign(<'g'^(x.23*x.28), x.22^inv((x.23*x.24))>, x.27)
         y     = (x.23*x.28)
         z     = x.22^(x.28*inv(x.24))
         z.1   = true
         z.2   = 'g'^(x.23*x.28)
    
     19. gx    = x.22^inv((x.23*x.24))
         pka   = pk(x.27)
         signa = sign(<'g'^(x.23*inv(x.28)), x.22^inv((x.23*x.24))>, x.27)
         y     = (x.23*inv(x.28))
         z     = x.22^inv((x.24*x.28))
         z.1   = true
         z.2   = 'g'^(x.23*inv(x.28))
    
     20. gx    = x.22^(x.23*x.24)
         pka   = pk(x.27)
         signa = sign(<'g'^inv((x.23*x.28)), x.22^(x.23*x.24)>, x.27)
         y     = inv((x.23*x.28))
         z     = x.22^(x.24*inv(x.28))
         z.1   = true
         z.2   = 'g'^inv((x.23*x.28))
    
     21. gx    = x.22^(x.23*x.24)
         pka   = pk(x.27)
         signa = sign(<'g'^(x.28*inv(x.23)), x.22^(x.23*x.24)>, x.27)
         y     = (x.28*inv(x.23))
         z     = x.22^(x.24*x.28)
         z.1   = true
         z.2   = 'g'^(x.28*inv(x.23))
    
     22. gx    = x.22^(x.23*x.24*inv(x.25))
         pka   = pk(x.28)
         signa = sign(<'g'^(x.25*inv(x.24)), x.22^(x.23*x.24*inv(x.25))>,
                      x.28)
         y     = (x.25*inv(x.24))
         z     = x.22^x.23
         z.1   = true
         z.2   = 'g'^(x.25*inv(x.24))
    
     23. gx    = x.22^(x.23*inv(x.24))
         pka   = pk(x.27)
         signa = sign(<'g'^inv(x.28), x.22^(x.23*inv(x.24))>, x.27)
         y     = inv(x.28)
         z     = x.22^(x.23*inv((x.24*x.28)))
         z.1   = true
         z.2   = 'g'^inv(x.28)
    
     24. gx    = x.22^(x.23*inv(x.24))
         pka   = pk(x.27)
         signa = sign(<'g'^inv((x.23*x.28)), x.22^(x.23*inv(x.24))>, x.27)
         y     = inv((x.23*x.28))
         z     = x.22^inv((x.24*x.28))
         z.1   = true
         z.2   = 'g'^inv((x.23*x.28))
    
     25. gx    = x.22^(x.23*inv(x.24))
         pka   = pk(x.27)
         signa = sign(<'g'^(x.24*x.28), x.22^(x.23*inv(x.24))>, x.27)
         y     = (x.24*x.28)
         z     = x.22^(x.23*x.28)
         z.1   = true
         z.2   = 'g'^(x.24*x.28)
    
     26. gx    = x.22^(x.23*inv(x.24))
         pka   = pk(x.27)
         signa = sign(<'g'^(x.24*x.28*inv(x.23)), x.22^(x.23*inv(x.24))>,
                      x.27)
         y     = (x.24*x.28*inv(x.23))
         z     = x.22^x.28
         z.1   = true
         z.2   = 'g'^(x.24*x.28*inv(x.23))
    
     27. gx    = x.22^(x.23*inv(x.24))
         pka   = pk(x.27)
         signa = sign(<'g'^(x.24*inv((x.23*x.28))), x.22^(x.23*inv(x.24))>,
                      x.27)
         y     = (x.24*inv((x.23*x.28)))
         z     = x.22^inv(x.28)
         z.1   = true
         z.2   = 'g'^(x.24*inv((x.23*x.28)))
    
     28. gx    = x.22^(x.23*inv((x.24*x.25)))
         pka   = pk(x.28)
         signa = sign(<'g'^(x.25*inv(x.23)), x.22^(x.23*inv((x.24*x.25)))>,
                      x.28)
         y     = (x.25*inv(x.23))
         z     = x.22^inv(x.24)
         z.1   = true
         z.2   = 'g'^(x.25*inv(x.23))
    
     29. gx    = z.22^inv(y.21)
         pka   = pka.19
         signa = signa.20
         y     = y.21
         z     = z.22
         z.1   = verify(signa.20, <'g'^y.21, z.22^inv(y.21)>, pka.19)
         z.2   = 'g'^y.21
    
     30. gx    = x.23^inv((x.24*x.25))
         pka   = pk(x.28)
         signa = sign(<'g'^(x.24*x.29*inv(x.30)), x.23^inv((x.24*x.25))>,
                      x.28)
         y     = (x.24*x.29*inv(x.30))
         z     = x.23^(x.29*inv((x.25*x.30)))
         z.1   = true
         z.2   = 'g'^(x.24*x.29*inv(x.30))
    
     31. gx    = x.23^(x.24*x.25)
         pka   = pk(x.28)
         signa = sign(<'g'^(x.29*inv((x.24*x.30))), x.23^(x.24*x.25)>, x.28)
         y     = (x.29*inv((x.24*x.30)))
         z     = x.23^(x.25*x.29*inv(x.30))
         z.1   = true
         z.2   = 'g'^(x.29*inv((x.24*x.30)))
    
     32. gx    = x.23^(x.24*x.25*inv(x.26))
         pka   = pk(x.29)
         signa = sign(<'g'^inv((x.25*x.30)), x.23^(x.24*x.25*inv(x.26))>,
                      x.29)
         y     = inv((x.25*x.30))
         z     = x.23^(x.24*inv((x.26*x.30)))
         z.1   = true
         z.2   = 'g'^inv((x.25*x.30))
    
     33. gx    = x.23^(x.24*x.25*inv(x.26))
         pka   = pk(x.29)
         signa = sign(<'g'^(x.26*x.30*inv(x.24)), x.23^(x.24*x.25*inv(x.26))
                      >,
                      x.29)
         y     = (x.26*x.30*inv(x.24))
         z     = x.23^(x.25*x.30)
         z.1   = true
         z.2   = 'g'^(x.26*x.30*inv(x.24))
    
     34. gx    = x.23^(x.24*x.25*inv(x.26))
         pka   = pk(x.29)
         signa = sign(<'g'^(x.26*inv((x.24*x.30))), 
                       x.23^(x.24*x.25*inv(x.26))>,
                      x.29)
         y     = (x.26*inv((x.24*x.30)))
         z     = x.23^(x.25*inv(x.30))
         z.1   = true
         z.2   = 'g'^(x.26*inv((x.24*x.30)))
    
     35. gx    = x.23^(x.24*x.25*inv((x.26*x.27)))
         pka   = pk(x.30)
         signa = sign(<'g'^(x.27*inv(x.25)), 
                       x.23^(x.24*x.25*inv((x.26*x.27)))>,
                      x.30)
         y     = (x.27*inv(x.25))
         z     = x.23^(x.24*inv(x.26))
         z.1   = true
         z.2   = 'g'^(x.27*inv(x.25))
    
     36. gx    = x.23^(x.24*inv(x.25))
         pka   = pk(x.28)
         signa = sign(<'g'^(x.25*x.29*inv((x.24*x.30))), 
                       x.23^(x.24*inv(x.25))>,
                      x.28)
         y     = (x.25*x.29*inv((x.24*x.30)))
         z     = x.23^(x.29*inv(x.30))
         z.1   = true
         z.2   = 'g'^(x.25*x.29*inv((x.24*x.30)))
    
     37. gx    = x.23^(x.24*inv(x.25))
         pka   = pk(x.28)
         signa = sign(<'g'^(x.29*inv(x.30)), x.23^(x.24*inv(x.25))>, x.28)
         y     = (x.29*inv(x.30))
         z     = x.23^(x.24*x.29*inv((x.25*x.30)))
         z.1   = true
         z.2   = 'g'^(x.29*inv(x.30))
    
     38. gx    = x.23^(x.24*inv(x.25))
         pka   = pk(x.28)
         signa = sign(<'g'^(x.29*inv((x.24*x.30))), x.23^(x.24*inv(x.25))>,
                      x.28)
         y     = (x.29*inv((x.24*x.30)))
         z     = x.23^(x.29*inv((x.25*x.30)))
         z.1   = true
         z.2   = 'g'^(x.29*inv((x.24*x.30)))
    
     39. gx    = x.23^(x.24*inv((x.25*x.26)))
         pka   = pk(x.29)
         signa = sign(<'g'^(x.25*x.30), x.23^(x.24*inv((x.25*x.26)))>, x.29)
         y     = (x.25*x.30)
         z     = x.23^(x.24*x.30*inv(x.26))
         z.1   = true
         z.2   = 'g'^(x.25*x.30)
    
     40. gx    = x.23^(x.24*inv((x.25*x.26)))
         pka   = pk(x.29)
         signa = sign(<'g'^(x.25*x.30*inv(x.24)), 
                       x.23^(x.24*inv((x.25*x.26)))>,
                      x.29)
         y     = (x.25*x.30*inv(x.24))
         z     = x.23^(x.30*inv(x.26))
         z.1   = true
         z.2   = 'g'^(x.25*x.30*inv(x.24))
    
     41. gx    = x.23^(x.24*inv((x.25*x.26)))
         pka   = pk(x.29)
         signa = sign(<'g'^(x.25*inv(x.30)), x.23^(x.24*inv((x.25*x.26)))>,
                      x.29)
         y     = (x.25*inv(x.30))
         z     = x.23^(x.24*inv((x.26*x.30)))
         z.1   = true
         z.2   = 'g'^(x.25*inv(x.30))
    
     42. gx    = x.23^(x.24*inv((x.25*x.26)))
         pka   = pk(x.29)
         signa = sign(<'g'^(x.25*inv((x.24*x.30))), 
                       x.23^(x.24*inv((x.25*x.26)))>,
                      x.29)
         y     = (x.25*inv((x.24*x.30)))
         z     = x.23^inv((x.26*x.30))
         z.1   = true
         z.2   = 'g'^(x.25*inv((x.24*x.30)))
    
     43. gx    = x.24^(x.25*x.26*inv(x.27))
         pka   = pk(x.30)
         signa = sign(<'g'^(x.27*x.31*inv((x.25*x.32))), 
                       x.24^(x.25*x.26*inv(x.27))>,
                      x.30)
         y     = (x.27*x.31*inv((x.25*x.32)))
         z     = x.24^(x.26*x.31*inv(x.32))
         z.1   = true
         z.2   = 'g'^(x.27*x.31*inv((x.25*x.32)))
    
     44. gx    = x.24^(x.25*x.26*inv(x.27))
         pka   = pk(x.30)
         signa = sign(<'g'^(x.31*inv((x.25*x.32))), 
                       x.24^(x.25*x.26*inv(x.27))>,
                      x.30)
         y     = (x.31*inv((x.25*x.32)))
         z     = x.24^(x.26*x.31*inv((x.27*x.32)))
         z.1   = true
         z.2   = 'g'^(x.31*inv((x.25*x.32)))
    
     45. gx    = x.24^(x.25*x.26*inv((x.27*x.28)))
         pka   = pk(x.31)
         signa = sign(<'g'^(x.27*x.32*inv(x.25)), 
                       x.24^(x.25*x.26*inv((x.27*x.28)))>,
                      x.31)
         y     = (x.27*x.32*inv(x.25))
         z     = x.24^(x.26*x.32*inv(x.28))
         z.1   = true
         z.2   = 'g'^(x.27*x.32*inv(x.25))
    
     46. gx    = x.24^(x.25*x.26*inv((x.27*x.28)))
         pka   = pk(x.31)
         signa = sign(<'g'^(x.27*inv((x.25*x.32))), 
                       x.24^(x.25*x.26*inv((x.27*x.28)))>,
                      x.31)
         y     = (x.27*inv((x.25*x.32)))
         z     = x.24^(x.26*inv((x.28*x.32)))
         z.1   = true
         z.2   = 'g'^(x.27*inv((x.25*x.32)))
    
     47. gx    = x.24^(x.25*inv((x.26*x.27)))
         pka   = pk(x.30)
         signa = sign(<'g'^(x.26*x.31*inv(x.32)), 
                       x.24^(x.25*inv((x.26*x.27)))>,
                      x.30)
         y     = (x.26*x.31*inv(x.32))
         z     = x.24^(x.25*x.31*inv((x.27*x.32)))
         z.1   = true
         z.2   = 'g'^(x.26*x.31*inv(x.32))
    
     48. gx    = x.24^(x.25*inv((x.26*x.27)))
         pka   = pk(x.30)
         signa = sign(<'g'^(x.26*x.31*inv((x.25*x.32))), 
                       x.24^(x.25*inv((x.26*x.27)))>,
                      x.30)
         y     = (x.26*x.31*inv((x.25*x.32)))
         z     = x.24^(x.31*inv((x.27*x.32)))
         z.1   = true
         z.2   = 'g'^(x.26*x.31*inv((x.25*x.32)))
    
     49. gx    = x.25^(x.26*x.27*inv((x.28*x.29)))
         pka   = pk(x.32)
         signa = sign(<'g'^(x.28*x.33*inv((x.26*x.34))), 
                       x.25^(x.26*x.27*inv((x.28*x.29)))>,
                      x.32)
         y     = (x.28*x.33*inv((x.26*x.34)))
         z     = x.25^(x.27*x.33*inv((x.29*x.34)))
         z.1   = true
         z.2   = 'g'^(x.28*x.33*inv((x.26*x.34)))
    
     50. gx    = z.32^x.51
         pka   = pk(x.54)
         signa = sign(<'g'^inv(x.51), z.32^x.51>, x.54)
         y     = inv(x.51)
         z     = z.32
         z.1   = true
         z.2   = 'g'^inv(x.51)
    
     51. gx    = z.33^(x.52*inv(x.53))
         pka   = pk(x.56)
         signa = sign(<'g'^(x.53*inv(x.52)), z.33^(x.52*inv(x.53))>, x.56)
         y     = (x.53*inv(x.52))
         z     = z.33
         z.1   = true
         z.2   = 'g'^(x.53*inv(x.52))
    
     52. gx    = z.35^x.58
         pka   = mac(<'g'^inv(x.58), z.35^x.58>, signa.33)
         signa = signa.33
         y     = inv(x.58)
         z     = z.35
         z.1   = true
         z.2   = 'g'^inv(x.58)
    
     53. gx    = z.35^inv(y.34)
         pka   = pk(x.59)
         signa = sign(<'g'^y.34, z.35^inv(y.34)>, x.59)
         y     = y.34
         z     = z.35
         z.1   = true
         z.2   = 'g'^y.34
    
     54. gx    = z.36^(x.59*inv(x.60))
         pka   = mac(<'g'^(x.60*inv(x.59)), z.36^(x.59*inv(x.60))>,
                     signa.34)
         signa = signa.34
         y     = (x.60*inv(x.59))
         z     = z.36
         z.1   = true
         z.2   = 'g'^(x.60*inv(x.59))
    
     55. gx    = z.38^x.63
         pka   = pka.35
         signa = signa.36
         y     = inv(x.63)
         z     = z.38
         z.1   = verify(signa.36, <'g'^inv(x.63), z.38^x.63>, pka.35)
         z.2   = 'g'^inv(x.63)
    
     56. gx    = z.39^(x.64*inv(x.65))
         pka   = pka.36
         signa = signa.37
         y     = (x.65*inv(x.64))
         z     = z.39
         z.1   = verify(signa.37,
                        <'g'^(x.65*inv(x.64)), z.39^(x.64*inv(x.65))>, pka.36)
         z.2   = 'g'^(x.65*inv(x.64))
    
     57. gx    = x.55^x.56
         pka   = pk(x.59)
         signa = sign(<'g'^y.34, x.55^x.56>, x.59)
         y     = y.34
         z     = x.55^(y.34*x.56)
         z.1   = true
         z.2   = 'g'^y.34
    
     58. gx    = x.56^inv((y.35*x.57))
         pka   = pk(x.61)
         signa = sign(<'g'^y.35, x.56^inv((y.35*x.57))>, x.61)
         y     = y.35
         z     = x.56^inv(x.57)
         z.1   = true
         z.2   = 'g'^y.35
    
     59. gx    = x.56^(x.57*inv(y.35))
         pka   = pk(x.61)
         signa = sign(<'g'^y.35, x.56^(x.57*inv(y.35))>, x.61)
         y     = y.35
         z     = x.56^x.57
         z.1   = true
         z.2   = 'g'^y.35
    
     60. gx    = x.57^x.58
         pka   = mac(<'g'^y.34, x.57^x.58>, signa.33)
         signa = signa.33
         y     = y.34
         z     = x.57^(y.34*x.58)
         z.1   = true
         z.2   = 'g'^y.34
    
     61. gx    = x.57^inv((y.34*x.58))
         pka   = mac(<'g'^y.34, x.57^inv((y.34*x.58))>, signa.33)
         signa = signa.33
         y     = y.34
         z     = x.57^inv(x.58)
         z.1   = true
         z.2   = 'g'^y.34
    
     62. gx    = x.57^(x.58*inv(y.34))
         pka   = mac(<'g'^y.34, x.57^(x.58*inv(y.34))>, signa.33)
         signa = signa.33
         y     = y.34
         z     = x.57^x.58
         z.1   = true
         z.2   = 'g'^y.34
    
     63. gx    = x.57^(x.58*inv((y.36*x.59)))
         pka   = pk(x.63)
         signa = sign(<'g'^y.36, x.57^(x.58*inv((y.36*x.59)))>, x.63)
         y     = y.36
         z     = x.57^(x.58*inv(x.59))
         z.1   = true
         z.2   = 'g'^y.36
    
     64. gx    = x.58^(x.59*x.60)
         pka   = mac(<'g'^inv(x.59), x.58^(x.59*x.60)>, signa.34)
         signa = signa.34
         y     = inv(x.59)
         z     = x.58^x.60
         z.1   = true
         z.2   = 'g'^inv(x.59)
    
     65. gx    = x.58^(x.59*inv((y.35*x.60)))
         pka   = mac(<'g'^y.35, x.58^(x.59*inv((y.35*x.60)))>, signa.34)
         signa = signa.34
         y     = y.35
         z     = x.58^(x.59*inv(x.60))
         z.1   = true
         z.2   = 'g'^y.35
    
     66. gx    = x.59^(x.60*x.61*inv(x.62))
         pka   = mac(<'g'^(x.62*inv(x.61)), x.59^(x.60*x.61*inv(x.62))>,
                     signa.35)
         signa = signa.35
         y     = (x.62*inv(x.61))
         z     = x.59^x.60
         z.1   = true
         z.2   = 'g'^(x.62*inv(x.61))
    
     67. gx    = x.59^(x.60*inv((x.61*x.62)))
         pka   = mac(<'g'^(x.62*inv(x.60)), x.59^(x.60*inv((x.61*x.62)))>,
                     signa.35)
         signa = signa.35
         y     = (x.62*inv(x.60))
         z     = x.59^inv(x.61)
         z.1   = true
         z.2   = 'g'^(x.62*inv(x.60))
    
     68. gx    = x.60^x.61
         pka   = mac(<'g'^inv((x.61*x.64)), x.60^x.61>, signa.36)
         signa = signa.36
         y     = inv((x.61*x.64))
         z     = x.60^inv(x.64)
         z.1   = true
         z.2   = 'g'^inv((x.61*x.64))
    
     69. gx    = x.60^x.61
         pka   = mac(<'g'^(x.64*inv(x.61)), x.60^x.61>, signa.36)
         signa = signa.36
         y     = (x.64*inv(x.61))
         z     = x.60^x.64
         z.1   = true
         z.2   = 'g'^(x.64*inv(x.61))
    
     70. gx    = x.60^inv(x.61)
         pka   = mac(<'g'^inv(x.64), x.60^inv(x.61)>, signa.36)
         signa = signa.36
         y     = inv(x.64)
         z     = x.60^inv((x.61*x.64))
         z.1   = true
         z.2   = 'g'^inv(x.64)
    
     71. gx    = x.60^inv(x.61)
         pka   = mac(<'g'^(x.61*x.64), x.60^inv(x.61)>, signa.36)
         signa = signa.36
         y     = (x.61*x.64)
         z     = x.60^x.64
         z.1   = true
         z.2   = 'g'^(x.61*x.64)
    
     72. gx    = x.60^(x.61*x.62*inv((x.63*x.64)))
         pka   = mac(<'g'^(x.64*inv(x.62)), 
                      x.60^(x.61*x.62*inv((x.63*x.64)))>,
                     signa.36)
         signa = signa.36
         y     = (x.64*inv(x.62))
         z     = x.60^(x.61*inv(x.63))
         z.1   = true
         z.2   = 'g'^(x.64*inv(x.62))
    
     73. gx    = x.61^x.62
         pka   = mac(<'g'^(x.65*inv((x.62*x.66))), x.61^x.62>, signa.37)
         signa = signa.37
         y     = (x.65*inv((x.62*x.66)))
         z     = x.61^(x.65*inv(x.66))
         z.1   = true
         z.2   = 'g'^(x.65*inv((x.62*x.66)))
    
     74. gx    = x.61^inv(x.62)
         pka   = mac(<'g'^(x.65*inv(x.66)), x.61^inv(x.62)>, signa.37)
         signa = signa.37
         y     = (x.65*inv(x.66))
         z     = x.61^(x.65*inv((x.62*x.66)))
         z.1   = true
         z.2   = 'g'^(x.65*inv(x.66))
    
     75. gx    = x.61^inv((x.62*x.63))
         pka   = mac(<'g'^(x.62*x.66), x.61^inv((x.62*x.63))>, signa.37)
         signa = signa.37
         y     = (x.62*x.66)
         z     = x.61^(x.66*inv(x.63))
         z.1   = true
         z.2   = 'g'^(x.62*x.66)
    
     76. gx    = x.61^inv((x.62*x.63))
         pka   = mac(<'g'^(x.62*inv(x.66)), x.61^inv((x.62*x.63))>,
                     signa.37)
         signa = signa.37
         y     = (x.62*inv(x.66))
         z     = x.61^inv((x.63*x.66))
         z.1   = true
         z.2   = 'g'^(x.62*inv(x.66))
    
     77. gx    = x.61^(x.62*x.63)
         pka   = mac(<'g'^inv((x.62*x.66)), x.61^(x.62*x.63)>, signa.37)
         signa = signa.37
         y     = inv((x.62*x.66))
         z     = x.61^(x.63*inv(x.66))
         z.1   = true
         z.2   = 'g'^inv((x.62*x.66))
    
     78. gx    = x.61^(x.62*x.63)
         pka   = mac(<'g'^(x.66*inv(x.62)), x.61^(x.62*x.63)>, signa.37)
         signa = signa.37
         y     = (x.66*inv(x.62))
         z     = x.61^(x.63*x.66)
         z.1   = true
         z.2   = 'g'^(x.66*inv(x.62))
    
     79. gx    = x.61^(x.62*inv(x.63))
         pka   = mac(<'g'^inv(x.66), x.61^(x.62*inv(x.63))>, signa.37)
         signa = signa.37
         y     = inv(x.66)
         z     = x.61^(x.62*inv((x.63*x.66)))
         z.1   = true
         z.2   = 'g'^inv(x.66)
    
     80. gx    = x.61^(x.62*inv(x.63))
         pka   = mac(<'g'^inv((x.62*x.66)), x.61^(x.62*inv(x.63))>,
                     signa.37)
         signa = signa.37
         y     = inv((x.62*x.66))
         z     = x.61^inv((x.63*x.66))
         z.1   = true
         z.2   = 'g'^inv((x.62*x.66))
    
     81. gx    = x.61^(x.62*inv(x.63))
         pka   = mac(<'g'^(x.63*x.66), x.61^(x.62*inv(x.63))>, signa.37)
         signa = signa.37
         y     = (x.63*x.66)
         z     = x.61^(x.62*x.66)
         z.1   = true
         z.2   = 'g'^(x.63*x.66)
    
     82. gx    = x.61^(x.62*inv(x.63))
         pka   = mac(<'g'^(x.63*x.66*inv(x.62)), x.61^(x.62*inv(x.63))>,
                     signa.37)
         signa = signa.37
         y     = (x.63*x.66*inv(x.62))
         z     = x.61^x.66
         z.1   = true
         z.2   = 'g'^(x.63*x.66*inv(x.62))
    
     83. gx    = x.61^(x.62*inv(x.63))
         pka   = mac(<'g'^(x.63*inv((x.62*x.66))), x.61^(x.62*inv(x.63))>,
                     signa.37)
         signa = signa.37
         y     = (x.63*inv((x.62*x.66)))
         z     = x.61^inv(x.66)
         z.1   = true
         z.2   = 'g'^(x.63*inv((x.62*x.66)))
    
     84. gx    = x.62^x.63
         pka   = pka.35
         signa = signa.36
         y     = y.37
         z     = x.62^(y.37*x.63)
         z.1   = verify(signa.36, <'g'^y.37, x.62^x.63>, pka.35)
         z.2   = 'g'^y.37
    
     85. gx    = x.62^inv((y.37*x.63))
         pka   = pka.35
         signa = signa.36
         y     = y.37
         z     = x.62^inv(x.63)
         z.1   = verify(signa.36, <'g'^y.37, x.62^inv((y.37*x.63))>, pka.35)
         z.2   = 'g'^y.37
    
     86. gx    = x.62^inv((x.63*x.64))
         pka   = mac(<'g'^(x.63*x.67*inv(x.68)), x.62^inv((x.63*x.64))>,
                     signa.38)
         signa = signa.38
         y     = (x.63*x.67*inv(x.68))
         z     = x.62^(x.67*inv((x.64*x.68)))
         z.1   = true
         z.2   = 'g'^(x.63*x.67*inv(x.68))
    
     87. gx    = x.62^(x.63*x.64)
         pka   = mac(<'g'^(x.67*inv((x.63*x.68))), x.62^(x.63*x.64)>,
                     signa.38)
         signa = signa.38
         y     = (x.67*inv((x.63*x.68)))
         z     = x.62^(x.64*x.67*inv(x.68))
         z.1   = true
         z.2   = 'g'^(x.67*inv((x.63*x.68)))
    
     88. gx    = x.62^(x.63*x.64*inv(x.65))
         pka   = mac(<'g'^inv((x.64*x.68)), x.62^(x.63*x.64*inv(x.65))>,
                     signa.38)
         signa = signa.38
         y     = inv((x.64*x.68))
         z     = x.62^(x.63*inv((x.65*x.68)))
         z.1   = true
         z.2   = 'g'^inv((x.64*x.68))
    
     89. gx    = x.62^(x.63*x.64*inv(x.65))
         pka   = mac(<'g'^(x.65*x.68*inv(x.63)), x.62^(x.63*x.64*inv(x.65))
                     >,
                     signa.38)
         signa = signa.38
         y     = (x.65*x.68*inv(x.63))
         z     = x.62^(x.64*x.68)
         z.1   = true
         z.2   = 'g'^(x.65*x.68*inv(x.63))
    
     90. gx    = x.62^(x.63*x.64*inv(x.65))
         pka   = mac(<'g'^(x.65*inv((x.63*x.68))), 
                      x.62^(x.63*x.64*inv(x.65))>,
                     signa.38)
         signa = signa.38
         y     = (x.65*inv((x.63*x.68)))
         z     = x.62^(x.64*inv(x.68))
         z.1   = true
         z.2   = 'g'^(x.65*inv((x.63*x.68)))
    
     91. gx    = x.62^(x.63*inv(y.37))
         pka   = pka.35
         signa = signa.36
         y     = y.37
         z     = x.62^x.63
         z.1   = verify(signa.36, <'g'^y.37, x.62^(x.63*inv(y.37))>, pka.35)
         z.2   = 'g'^y.37
    
     92. gx    = x.62^(x.63*inv(x.64))
         pka   = mac(<'g'^(x.64*x.67*inv((x.63*x.68))), 
                      x.62^(x.63*inv(x.64))>,
                     signa.38)
         signa = signa.38
         y     = (x.64*x.67*inv((x.63*x.68)))
         z     = x.62^(x.67*inv(x.68))
         z.1   = true
         z.2   = 'g'^(x.64*x.67*inv((x.63*x.68)))
    
     93. gx    = x.62^(x.63*inv(x.64))
         pka   = mac(<'g'^(x.67*inv(x.68)), x.62^(x.63*inv(x.64))>,
                     signa.38)
         signa = signa.38
         y     = (x.67*inv(x.68))
         z     = x.62^(x.63*x.67*inv((x.64*x.68)))
         z.1   = true
         z.2   = 'g'^(x.67*inv(x.68))
    
     94. gx    = x.62^(x.63*inv(x.64))
         pka   = mac(<'g'^(x.67*inv((x.63*x.68))), x.62^(x.63*inv(x.64))>,
                     signa.38)
         signa = signa.38
         y     = (x.67*inv((x.63*x.68)))
         z     = x.62^(x.67*inv((x.64*x.68)))
         z.1   = true
         z.2   = 'g'^(x.67*inv((x.63*x.68)))
    
     95. gx    = x.62^(x.63*inv((x.64*x.65)))
         pka   = mac(<'g'^(x.64*x.68), x.62^(x.63*inv((x.64*x.65)))>,
                     signa.38)
         signa = signa.38
         y     = (x.64*x.68)
         z     = x.62^(x.63*x.68*inv(x.65))
         z.1   = true
         z.2   = 'g'^(x.64*x.68)
    
     96. gx    = x.62^(x.63*inv((x.64*x.65)))
         pka   = mac(<'g'^(x.64*x.68*inv(x.63)), 
                      x.62^(x.63*inv((x.64*x.65)))>,
                     signa.38)
         signa = signa.38
         y     = (x.64*x.68*inv(x.63))
         z     = x.62^(x.68*inv(x.65))
         z.1   = true
         z.2   = 'g'^(x.64*x.68*inv(x.63))
    
     97. gx    = x.62^(x.63*inv((x.64*x.65)))
         pka   = mac(<'g'^(x.64*inv(x.68)), x.62^(x.63*inv((x.64*x.65)))>,
                     signa.38)
         signa = signa.38
         y     = (x.64*inv(x.68))
         z     = x.62^(x.63*inv((x.65*x.68)))
         z.1   = true
         z.2   = 'g'^(x.64*inv(x.68))
    
     98. gx    = x.62^(x.63*inv((x.64*x.65)))
         pka   = mac(<'g'^(x.64*inv((x.63*x.68))), 
                      x.62^(x.63*inv((x.64*x.65)))>,
                     signa.38)
         signa = signa.38
         y     = (x.64*inv((x.63*x.68)))
         z     = x.62^inv((x.65*x.68))
         z.1   = true
         z.2   = 'g'^(x.64*inv((x.63*x.68)))
    
     99. gx    = x.63^(x.64*x.65)
         pka   = pka.36
         signa = signa.37
         y     = inv(x.64)
         z     = x.63^x.65
         z.1   = verify(signa.37, <'g'^inv(x.64), x.63^(x.64*x.65)>, pka.36)
         z.2   = 'g'^inv(x.64)
    
    100. gx    = x.63^(x.64*x.65*inv(x.66))
         pka   = mac(<'g'^(x.66*x.69*inv((x.64*x.70))), 
                      x.63^(x.64*x.65*inv(x.66))>,
                     signa.39)
         signa = signa.39
         y     = (x.66*x.69*inv((x.64*x.70)))
         z     = x.63^(x.65*x.69*inv(x.70))
         z.1   = true
         z.2   = 'g'^(x.66*x.69*inv((x.64*x.70)))
    
    101. gx    = x.63^(x.64*x.65*inv(x.66))
         pka   = mac(<'g'^(x.69*inv((x.64*x.70))), 
                      x.63^(x.64*x.65*inv(x.66))>,
                     signa.39)
         signa = signa.39
         y     = (x.69*inv((x.64*x.70)))
         z     = x.63^(x.65*x.69*inv((x.66*x.70)))
         z.1   = true
         z.2   = 'g'^(x.69*inv((x.64*x.70)))
    
    102. gx    = x.63^(x.64*x.65*inv((x.66*x.67)))
         pka   = mac(<'g'^(x.66*x.70*inv(x.64)), 
                      x.63^(x.64*x.65*inv((x.66*x.67)))>,
                     signa.39)
         signa = signa.39
         y     = (x.66*x.70*inv(x.64))
         z     = x.63^(x.65*x.70*inv(x.67))
         z.1   = true
         z.2   = 'g'^(x.66*x.70*inv(x.64))
    
    103. gx    = x.63^(x.64*x.65*inv((x.66*x.67)))
         pka   = mac(<'g'^(x.66*inv((x.64*x.70))), 
                      x.63^(x.64*x.65*inv((x.66*x.67)))>,
                     signa.39)
         signa = signa.39
         y     = (x.66*inv((x.64*x.70)))
         z     = x.63^(x.65*inv((x.67*x.70)))
         z.1   = true
         z.2   = 'g'^(x.66*inv((x.64*x.70)))
    
    104. gx    = x.63^(x.64*inv((y.38*x.65)))
         pka   = pka.36
         signa = signa.37
         y     = y.38
         z     = x.63^(x.64*inv(x.65))
         z.1   = verify(signa.37, <'g'^y.38, x.63^(x.64*inv((y.38*x.65)))>,
                        pka.36)
         z.2   = 'g'^y.38
    
    105. gx    = x.63^(x.64*inv((x.65*x.66)))
         pka   = mac(<'g'^(x.65*x.69*inv(x.70)), 
                      x.63^(x.64*inv((x.65*x.66)))>,
                     signa.39)
         signa = signa.39
         y     = (x.65*x.69*inv(x.70))
         z     = x.63^(x.64*x.69*inv((x.66*x.70)))
         z.1   = true
         z.2   = 'g'^(x.65*x.69*inv(x.70))
    
    106. gx    = x.63^(x.64*inv((x.65*x.66)))
         pka   = mac(<'g'^(x.65*x.69*inv((x.64*x.70))), 
                      x.63^(x.64*inv((x.65*x.66)))>,
                     signa.39)
         signa = signa.39
         y     = (x.65*x.69*inv((x.64*x.70)))
         z     = x.63^(x.69*inv((x.66*x.70)))
         z.1   = true
         z.2   = 'g'^(x.65*x.69*inv((x.64*x.70)))
    
    107. gx    = x.64^(x.65*x.66*inv(x.67))
         pka   = pka.37
         signa = signa.38
         y     = (x.67*inv(x.66))
         z     = x.64^x.65
         z.1   = verify(signa.38,
                        <'g'^(x.67*inv(x.66)), x.64^(x.65*x.66*inv(x.67))>, pka.37)
         z.2   = 'g'^(x.67*inv(x.66))
    
    108. gx    = x.64^(x.65*x.66*inv((x.67*x.68)))
         pka   = mac(<'g'^(x.67*x.71*inv((x.65*x.72))), 
                      x.64^(x.65*x.66*inv((x.67*x.68)))>,
                     signa.40)
         signa = signa.40
         y     = (x.67*x.71*inv((x.65*x.72)))
         z     = x.64^(x.66*x.71*inv((x.68*x.72)))
         z.1   = true
         z.2   = 'g'^(x.67*x.71*inv((x.65*x.72)))
    
    109. gx    = x.64^(x.65*inv((x.66*x.67)))
         pka   = pka.37
         signa = signa.38
         y     = (x.67*inv(x.65))
         z     = x.64^inv(x.66)
         z.1   = verify(signa.38,
                        <'g'^(x.67*inv(x.65)), x.64^(x.65*inv((x.66*x.67)))>, pka.37)
         z.2   = 'g'^(x.67*inv(x.65))
    
    110. gx    = x.65^(x.66*x.67*inv((x.68*x.69)))
         pka   = pka.38
         signa = signa.39
         y     = (x.69*inv(x.67))
         z     = x.65^(x.66*inv(x.68))
         z.1   = verify(signa.39,
                        <'g'^(x.69*inv(x.67)), x.65^(x.66*x.67*inv((x.68*x.69)))>, pka.38)
         z.2   = 'g'^(x.69*inv(x.67))
    
    111. gx    = x.67^x.68
         pka   = pka.40
         signa = signa.41
         y     = inv((x.68*x.73))
         z     = x.67^inv(x.73)
         z.1   = verify(signa.41, <'g'^inv((x.68*x.73)), x.67^x.68>, pka.40)
         z.2   = 'g'^inv((x.68*x.73))
    
    112. gx    = x.67^x.68
         pka   = pka.40
         signa = signa.41
         y     = (x.73*inv(x.68))
         z     = x.67^x.73
         z.1   = verify(signa.41, <'g'^(x.73*inv(x.68)), x.67^x.68>, pka.40)
         z.2   = 'g'^(x.73*inv(x.68))
    
    113. gx    = x.67^inv(x.68)
         pka   = pka.40
         signa = signa.41
         y     = inv(x.73)
         z     = x.67^inv((x.68*x.73))
         z.1   = verify(signa.41, <'g'^inv(x.73), x.67^inv(x.68)>, pka.40)
         z.2   = 'g'^inv(x.73)
    
    114. gx    = x.67^inv(x.68)
         pka   = pka.40
         signa = signa.41
         y     = (x.68*x.73)
         z     = x.67^x.73
         z.1   = verify(signa.41, <'g'^(x.68*x.73), x.67^inv(x.68)>, pka.40)
         z.2   = 'g'^(x.68*x.73)
    
    115. gx    = x.68^x.69
         pka   = pka.41
         signa = signa.42
         y     = (x.74*inv((x.69*x.75)))
         z     = x.68^(x.74*inv(x.75))
         z.1   = verify(signa.42, <'g'^(x.74*inv((x.69*x.75))), x.68^x.69>,
                        pka.41)
         z.2   = 'g'^(x.74*inv((x.69*x.75)))
    
    116. gx    = x.68^inv(x.69)
         pka   = pka.41
         signa = signa.42
         y     = (x.74*inv(x.75))
         z     = x.68^(x.74*inv((x.69*x.75)))
         z.1   = verify(signa.42, <'g'^(x.74*inv(x.75)), x.68^inv(x.69)>,
                        pka.41)
         z.2   = 'g'^(x.74*inv(x.75))
    
    117. gx    = x.68^inv((x.69*x.70))
         pka   = pka.41
         signa = signa.42
         y     = (x.69*x.75)
         z     = x.68^(x.75*inv(x.70))
         z.1   = verify(signa.42, <'g'^(x.69*x.75), x.68^inv((x.69*x.70))>,
                        pka.41)
         z.2   = 'g'^(x.69*x.75)
    
    118. gx    = x.68^inv((x.69*x.70))
         pka   = pka.41
         signa = signa.42
         y     = (x.69*inv(x.75))
         z     = x.68^inv((x.70*x.75))
         z.1   = verify(signa.42,
                        <'g'^(x.69*inv(x.75)), x.68^inv((x.69*x.70))>, pka.41)
         z.2   = 'g'^(x.69*inv(x.75))
    
    119. gx    = x.68^(x.69*x.70)
         pka   = pka.41
         signa = signa.42
         y     = inv((x.69*x.75))
         z     = x.68^(x.70*inv(x.75))
         z.1   = verify(signa.42, <'g'^inv((x.69*x.75)), x.68^(x.69*x.70)>,
                        pka.41)
         z.2   = 'g'^inv((x.69*x.75))
    
    120. gx    = x.68^(x.69*x.70)
         pka   = pka.41
         signa = signa.42
         y     = (x.75*inv(x.69))
         z     = x.68^(x.70*x.75)
         z.1   = verify(signa.42, <'g'^(x.75*inv(x.69)), x.68^(x.69*x.70)>,
                        pka.41)
         z.2   = 'g'^(x.75*inv(x.69))
    
    121. gx    = x.68^(x.69*inv(x.70))
         pka   = pka.41
         signa = signa.42
         y     = inv(x.75)
         z     = x.68^(x.69*inv((x.70*x.75)))
         z.1   = verify(signa.42, <'g'^inv(x.75), x.68^(x.69*inv(x.70))>,
                        pka.41)
         z.2   = 'g'^inv(x.75)
    
    122. gx    = x.68^(x.69*inv(x.70))
         pka   = pka.41
         signa = signa.42
         y     = inv((x.69*x.75))
         z     = x.68^inv((x.70*x.75))
         z.1   = verify(signa.42,
                        <'g'^inv((x.69*x.75)), x.68^(x.69*inv(x.70))>, pka.41)
         z.2   = 'g'^inv((x.69*x.75))
    
    123. gx    = x.68^(x.69*inv(x.70))
         pka   = pka.41
         signa = signa.42
         y     = (x.70*x.75)
         z     = x.68^(x.69*x.75)
         z.1   = verify(signa.42, <'g'^(x.70*x.75), x.68^(x.69*inv(x.70))>,
                        pka.41)
         z.2   = 'g'^(x.70*x.75)
    
    124. gx    = x.68^(x.69*inv(x.70))
         pka   = pka.41
         signa = signa.42
         y     = (x.70*x.75*inv(x.69))
         z     = x.68^x.75
         z.1   = verify(signa.42,
                        <'g'^(x.70*x.75*inv(x.69)), x.68^(x.69*inv(x.70))>, pka.41)
         z.2   = 'g'^(x.70*x.75*inv(x.69))
    
    125. gx    = x.68^(x.69*inv(x.70))
         pka   = pka.41
         signa = signa.42
         y     = (x.70*inv((x.69*x.75)))
         z     = x.68^inv(x.75)
         z.1   = verify(signa.42,
                        <'g'^(x.70*inv((x.69*x.75))), x.68^(x.69*inv(x.70))>, pka.41)
         z.2   = 'g'^(x.70*inv((x.69*x.75)))
    
    126. gx    = x.69^inv((x.70*x.71))
         pka   = pka.42
         signa = signa.43
         y     = (x.70*x.76*inv(x.77))
         z     = x.69^(x.76*inv((x.71*x.77)))
         z.1   = verify(signa.43,
                        <'g'^(x.70*x.76*inv(x.77)), x.69^inv((x.70*x.71))>, pka.42)
         z.2   = 'g'^(x.70*x.76*inv(x.77))
    
    127. gx    = x.69^(x.70*x.71)
         pka   = pka.42
         signa = signa.43
         y     = (x.76*inv((x.70*x.77)))
         z     = x.69^(x.71*x.76*inv(x.77))
         z.1   = verify(signa.43,
                        <'g'^(x.76*inv((x.70*x.77))), x.69^(x.70*x.71)>, pka.42)
         z.2   = 'g'^(x.76*inv((x.70*x.77)))
    
    128. gx    = x.69^(x.70*x.71*inv(x.72))
         pka   = pka.42
         signa = signa.43
         y     = inv((x.71*x.77))
         z     = x.69^(x.70*inv((x.72*x.77)))
         z.1   = verify(signa.43,
                        <'g'^inv((x.71*x.77)), x.69^(x.70*x.71*inv(x.72))>, pka.42)
         z.2   = 'g'^inv((x.71*x.77))
    
    129. gx    = x.69^(x.70*x.71*inv(x.72))
         pka   = pka.42
         signa = signa.43
         y     = (x.72*x.77*inv(x.70))
         z     = x.69^(x.71*x.77)
         z.1   = verify(signa.43,
                        <'g'^(x.72*x.77*inv(x.70)), x.69^(x.70*x.71*inv(x.72))>, pka.42)
         z.2   = 'g'^(x.72*x.77*inv(x.70))
    
    130. gx    = x.69^(x.70*x.71*inv(x.72))
         pka   = pka.42
         signa = signa.43
         y     = (x.72*inv((x.70*x.77)))
         z     = x.69^(x.71*inv(x.77))
         z.1   = verify(signa.43,
                        <'g'^(x.72*inv((x.70*x.77))), x.69^(x.70*x.71*inv(x.72))>, pka.42)
         z.2   = 'g'^(x.72*inv((x.70*x.77)))
    
    131. gx    = x.69^(x.70*inv(x.71))
         pka   = pka.42
         signa = signa.43
         y     = (x.71*x.76*inv((x.70*x.77)))
         z     = x.69^(x.76*inv(x.77))
         z.1   = verify(signa.43,
                        <'g'^(x.71*x.76*inv((x.70*x.77))), x.69^(x.70*inv(x.71))>, pka.42)
         z.2   = 'g'^(x.71*x.76*inv((x.70*x.77)))
    
    132. gx    = x.69^(x.70*inv(x.71))
         pka   = pka.42
         signa = signa.43
         y     = (x.76*inv(x.77))
         z     = x.69^(x.70*x.76*inv((x.71*x.77)))
         z.1   = verify(signa.43,
                        <'g'^(x.76*inv(x.77)), x.69^(x.70*inv(x.71))>, pka.42)
         z.2   = 'g'^(x.76*inv(x.77))
    
    133. gx    = x.69^(x.70*inv(x.71))
         pka   = pka.42
         signa = signa.43
         y     = (x.76*inv((x.70*x.77)))
         z     = x.69^(x.76*inv((x.71*x.77)))
         z.1   = verify(signa.43,
                        <'g'^(x.76*inv((x.70*x.77))), x.69^(x.70*inv(x.71))>, pka.42)
         z.2   = 'g'^(x.76*inv((x.70*x.77)))
    
    134. gx    = x.69^(x.70*inv((x.71*x.72)))
         pka   = pka.42
         signa = signa.43
         y     = (x.71*x.77)
         z     = x.69^(x.70*x.77*inv(x.72))
         z.1   = verify(signa.43,
                        <'g'^(x.71*x.77), x.69^(x.70*inv((x.71*x.72)))>, pka.42)
         z.2   = 'g'^(x.71*x.77)
    
    135. gx    = x.69^(x.70*inv((x.71*x.72)))
         pka   = pka.42
         signa = signa.43
         y     = (x.71*x.77*inv(x.70))
         z     = x.69^(x.77*inv(x.72))
         z.1   = verify(signa.43,
                        <'g'^(x.71*x.77*inv(x.70)), x.69^(x.70*inv((x.71*x.72)))>, pka.42)
         z.2   = 'g'^(x.71*x.77*inv(x.70))
    
    136. gx    = x.69^(x.70*inv((x.71*x.72)))
         pka   = pka.42
         signa = signa.43
         y     = (x.71*inv(x.77))
         z     = x.69^(x.70*inv((x.72*x.77)))
         z.1   = verify(signa.43,
                        <'g'^(x.71*inv(x.77)), x.69^(x.70*inv((x.71*x.72)))>, pka.42)
         z.2   = 'g'^(x.71*inv(x.77))
    
    137. gx    = x.69^(x.70*inv((x.71*x.72)))
         pka   = pka.42
         signa = signa.43
         y     = (x.71*inv((x.70*x.77)))
         z     = x.69^inv((x.72*x.77))
         z.1   = verify(signa.43,
                        <'g'^(x.71*inv((x.70*x.77))), x.69^(x.70*inv((x.71*x.72)))>,
                        pka.42)
         z.2   = 'g'^(x.71*inv((x.70*x.77)))
    
    138. gx    = x.70^(x.71*x.72*inv(x.73))
         pka   = pka.43
         signa = signa.44
         y     = (x.73*x.78*inv((x.71*x.79)))
         z     = x.70^(x.72*x.78*inv(x.79))
         z.1   = verify(signa.44,
                        <'g'^(x.73*x.78*inv((x.71*x.79))), x.70^(x.71*x.72*inv(x.73))>,
                        pka.43)
         z.2   = 'g'^(x.73*x.78*inv((x.71*x.79)))
    
    139. gx    = x.70^(x.71*x.72*inv(x.73))
         pka   = pka.43
         signa = signa.44
         y     = (x.78*inv((x.71*x.79)))
         z     = x.70^(x.72*x.78*inv((x.73*x.79)))
         z.1   = verify(signa.44,
                        <'g'^(x.78*inv((x.71*x.79))), x.70^(x.71*x.72*inv(x.73))>, pka.43)
         z.2   = 'g'^(x.78*inv((x.71*x.79)))
    
    140. gx    = x.70^(x.71*x.72*inv((x.73*x.74)))
         pka   = pka.43
         signa = signa.44
         y     = (x.73*x.79*inv(x.71))
         z     = x.70^(x.72*x.79*inv(x.74))
         z.1   = verify(signa.44,
                        <'g'^(x.73*x.79*inv(x.71)), x.70^(x.71*x.72*inv((x.73*x.74)))>,
                        pka.43)
         z.2   = 'g'^(x.73*x.79*inv(x.71))
    
    141. gx    = x.70^(x.71*x.72*inv((x.73*x.74)))
         pka   = pka.43
         signa = signa.44
         y     = (x.73*inv((x.71*x.79)))
         z     = x.70^(x.72*inv((x.74*x.79)))
         z.1   = verify(signa.44,
                        <'g'^(x.73*inv((x.71*x.79))), x.70^(x.71*x.72*inv((x.73*x.74)))>,
                        pka.43)
         z.2   = 'g'^(x.73*inv((x.71*x.79)))
    
    142. gx    = x.70^(x.71*inv((x.72*x.73)))
         pka   = pka.43
         signa = signa.44
         y     = (x.72*x.78*inv(x.79))
         z     = x.70^(x.71*x.78*inv((x.73*x.79)))
         z.1   = verify(signa.44,
                        <'g'^(x.72*x.78*inv(x.79)), x.70^(x.71*inv((x.72*x.73)))>, pka.43)
         z.2   = 'g'^(x.72*x.78*inv(x.79))
    
    143. gx    = x.70^(x.71*inv((x.72*x.73)))
         pka   = pka.43
         signa = signa.44
         y     = (x.72*x.78*inv((x.71*x.79)))
         z     = x.70^(x.78*inv((x.73*x.79)))
         z.1   = verify(signa.44,
                        <'g'^(x.72*x.78*inv((x.71*x.79))), x.70^(x.71*inv((x.72*x.73)))>,
                        pka.43)
         z.2   = 'g'^(x.72*x.78*inv((x.71*x.79)))
    
    144. gx    = x.71^(x.72*x.73*inv((x.74*x.75)))
         pka   = pka.44
         signa = signa.45
         y     = (x.74*x.80*inv((x.72*x.81)))
         z     = x.71^(x.73*x.80*inv((x.75*x.81)))
         z.1   = verify(signa.45,
                        <'g'^(x.74*x.80*inv((x.72*x.81))), 
                         x.71^(x.72*x.73*inv((x.74*x.75)))>,
                        pka.44)
         z.2   = 'g'^(x.74*x.80*inv((x.72*x.81)))
  */

rule (modulo E) B_4_send:
   [ St_B_4( A, B, idB, pka, kb, gx, y, h(gx^y) ) ]
  -->
   [
   St_B_5( A, B, idB, pka, kb, gx, y, h(gx^y) ),
   Out( <B, sign(<gx, 'g'^y>, kb), mac(<'1', B>, h(gx^y)), pk(kb)> )
   ]

  /*
  rule (modulo AC) B_4_send:
     [ St_B_4( A, B, idB, pka, kb, gx, y, h(z) ) ]
    -->
     [
     St_B_5( A, B, idB, pka, kb, gx, y, h(z) ),
     Out( <B, sign(<gx, z.1>, kb), mac(<'1', B>, h(z)), pk(kb)> )
     ]
    variants (modulo AC)
     1. gx    = gx.11
        y     = y.15
        z     = gx.11^y.15
        z.1   = 'g'^y.15
    
     2. gx    = gx.11
        y     = one
        z     = gx.11
        z.1   = 'g'
    
     3. gx    = DH_neutral
        y     = y.11
        z     = DH_neutral
        z.1   = 'g'^y.11
    
     4. gx    = z.12^x.15
        y     = inv(x.15)
        z     = z.12
        z.1   = 'g'^inv(x.15)
    
     5. gx    = x.13^(x.14*x.15)
        y     = inv(x.14)
        z     = x.13^x.15
        z.1   = 'g'^inv(x.14)
    
     6. gx    = z.13^inv(y.12)
        y     = y.12
        z     = z.13
        z.1   = 'g'^y.12
    
     7. gx    = z.13^(x.16*inv(x.17))
        y     = (x.17*inv(x.16))
        z     = z.13
        z.1   = 'g'^(x.17*inv(x.16))
    
     8. gx    = x.14^(x.15*x.16*inv(x.17))
        y     = (x.17*inv(x.16))
        z     = x.14^x.15
        z.1   = 'g'^(x.17*inv(x.16))
    
     9. gx    = x.14^(x.15*inv((x.16*x.17)))
        y     = (x.17*inv(x.15))
        z     = x.14^inv(x.16)
        z.1   = 'g'^(x.17*inv(x.15))
    
    10. gx    = x.15^(x.16*x.17*inv((x.18*x.19)))
        y     = (x.19*inv(x.17))
        z     = x.15^(x.16*inv(x.18))
        z.1   = 'g'^(x.19*inv(x.17))
    
    11. gx    = x.16^x.17
        y     = y.13
        z     = x.16^(y.13*x.17)
        z.1   = 'g'^y.13
    
    12. gx    = x.16^x.17
        y     = inv((x.17*x.21))
        z     = x.16^inv(x.21)
        z.1   = 'g'^inv((x.17*x.21))
    
    13. gx    = x.16^x.17
        y     = (x.21*inv(x.17))
        z     = x.16^x.21
        z.1   = 'g'^(x.21*inv(x.17))
    
    14. gx    = x.16^inv(x.17)
        y     = inv(x.21)
        z     = x.16^inv((x.17*x.21))
        z.1   = 'g'^inv(x.21)
    
    15. gx    = x.16^inv(x.17)
        y     = (x.17*x.21)
        z     = x.16^x.21
        z.1   = 'g'^(x.17*x.21)
    
    16. gx    = x.16^inv((y.13*x.17))
        y     = y.13
        z     = x.16^inv(x.17)
        z.1   = 'g'^y.13
    
    17. gx    = x.16^(x.17*inv(y.13))
        y     = y.13
        z     = x.16^x.17
        z.1   = 'g'^y.13
    
    18. gx    = x.17^x.18
        y     = (x.22*inv((x.18*x.23)))
        z     = x.17^(x.22*inv(x.23))
        z.1   = 'g'^(x.22*inv((x.18*x.23)))
    
    19. gx    = x.17^inv(x.18)
        y     = (x.22*inv(x.23))
        z     = x.17^(x.22*inv((x.18*x.23)))
        z.1   = 'g'^(x.22*inv(x.23))
    
    20. gx    = x.17^inv((x.18*x.19))
        y     = (x.18*x.23)
        z     = x.17^(x.23*inv(x.19))
        z.1   = 'g'^(x.18*x.23)
    
    21. gx    = x.17^inv((x.18*x.19))
        y     = (x.18*inv(x.23))
        z     = x.17^inv((x.19*x.23))
        z.1   = 'g'^(x.18*inv(x.23))
    
    22. gx    = x.17^(x.18*x.19)
        y     = inv((x.18*x.23))
        z     = x.17^(x.19*inv(x.23))
        z.1   = 'g'^inv((x.18*x.23))
    
    23. gx    = x.17^(x.18*x.19)
        y     = (x.23*inv(x.18))
        z     = x.17^(x.19*x.23)
        z.1   = 'g'^(x.23*inv(x.18))
    
    24. gx    = x.17^(x.18*inv(x.19))
        y     = inv(x.23)
        z     = x.17^(x.18*inv((x.19*x.23)))
        z.1   = 'g'^inv(x.23)
    
    25. gx    = x.17^(x.18*inv(x.19))
        y     = inv((x.18*x.23))
        z     = x.17^inv((x.19*x.23))
        z.1   = 'g'^inv((x.18*x.23))
    
    26. gx    = x.17^(x.18*inv(x.19))
        y     = (x.19*x.23)
        z     = x.17^(x.18*x.23)
        z.1   = 'g'^(x.19*x.23)
    
    27. gx    = x.17^(x.18*inv(x.19))
        y     = (x.19*x.23*inv(x.18))
        z     = x.17^x.23
        z.1   = 'g'^(x.19*x.23*inv(x.18))
    
    28. gx    = x.17^(x.18*inv(x.19))
        y     = (x.19*inv((x.18*x.23)))
        z     = x.17^inv(x.23)
        z.1   = 'g'^(x.19*inv((x.18*x.23)))
    
    29. gx    = x.17^(x.18*inv((y.14*x.19)))
        y     = y.14
        z     = x.17^(x.18*inv(x.19))
        z.1   = 'g'^y.14
    
    30. gx    = x.18^inv((x.19*x.20))
        y     = (x.19*x.24*inv(x.25))
        z     = x.18^(x.24*inv((x.20*x.25)))
        z.1   = 'g'^(x.19*x.24*inv(x.25))
    
    31. gx    = x.18^(x.19*x.20)
        y     = (x.24*inv((x.19*x.25)))
        z     = x.18^(x.20*x.24*inv(x.25))
        z.1   = 'g'^(x.24*inv((x.19*x.25)))
    
    32. gx    = x.18^(x.19*x.20*inv(x.21))
        y     = inv((x.20*x.25))
        z     = x.18^(x.19*inv((x.21*x.25)))
        z.1   = 'g'^inv((x.20*x.25))
    
    33. gx    = x.18^(x.19*x.20*inv(x.21))
        y     = (x.21*x.25*inv(x.19))
        z     = x.18^(x.20*x.25)
        z.1   = 'g'^(x.21*x.25*inv(x.19))
    
    34. gx    = x.18^(x.19*x.20*inv(x.21))
        y     = (x.21*inv((x.19*x.25)))
        z     = x.18^(x.20*inv(x.25))
        z.1   = 'g'^(x.21*inv((x.19*x.25)))
    
    35. gx    = x.18^(x.19*inv(x.20))
        y     = (x.20*x.24*inv((x.19*x.25)))
        z     = x.18^(x.24*inv(x.25))
        z.1   = 'g'^(x.20*x.24*inv((x.19*x.25)))
    
    36. gx    = x.18^(x.19*inv(x.20))
        y     = (x.24*inv(x.25))
        z     = x.18^(x.19*x.24*inv((x.20*x.25)))
        z.1   = 'g'^(x.24*inv(x.25))
    
    37. gx    = x.18^(x.19*inv(x.20))
        y     = (x.24*inv((x.19*x.25)))
        z     = x.18^(x.24*inv((x.20*x.25)))
        z.1   = 'g'^(x.24*inv((x.19*x.25)))
    
    38. gx    = x.18^(x.19*inv((x.20*x.21)))
        y     = (x.20*x.25)
        z     = x.18^(x.19*x.25*inv(x.21))
        z.1   = 'g'^(x.20*x.25)
    
    39. gx    = x.18^(x.19*inv((x.20*x.21)))
        y     = (x.20*x.25*inv(x.19))
        z     = x.18^(x.25*inv(x.21))
        z.1   = 'g'^(x.20*x.25*inv(x.19))
    
    40. gx    = x.18^(x.19*inv((x.20*x.21)))
        y     = (x.20*inv(x.25))
        z     = x.18^(x.19*inv((x.21*x.25)))
        z.1   = 'g'^(x.20*inv(x.25))
    
    41. gx    = x.18^(x.19*inv((x.20*x.21)))
        y     = (x.20*inv((x.19*x.25)))
        z     = x.18^inv((x.21*x.25))
        z.1   = 'g'^(x.20*inv((x.19*x.25)))
    
    42. gx    = x.19^(x.20*x.21*inv(x.22))
        y     = (x.22*x.26*inv((x.20*x.27)))
        z     = x.19^(x.21*x.26*inv(x.27))
        z.1   = 'g'^(x.22*x.26*inv((x.20*x.27)))
    
    43. gx    = x.19^(x.20*x.21*inv(x.22))
        y     = (x.26*inv((x.20*x.27)))
        z     = x.19^(x.21*x.26*inv((x.22*x.27)))
        z.1   = 'g'^(x.26*inv((x.20*x.27)))
    
    44. gx    = x.19^(x.20*x.21*inv((x.22*x.23)))
        y     = (x.22*x.27*inv(x.20))
        z     = x.19^(x.21*x.27*inv(x.23))
        z.1   = 'g'^(x.22*x.27*inv(x.20))
    
    45. gx    = x.19^(x.20*x.21*inv((x.22*x.23)))
        y     = (x.22*inv((x.20*x.27)))
        z     = x.19^(x.21*inv((x.23*x.27)))
        z.1   = 'g'^(x.22*inv((x.20*x.27)))
    
    46. gx    = x.19^(x.20*inv((x.21*x.22)))
        y     = (x.21*x.26*inv(x.27))
        z     = x.19^(x.20*x.26*inv((x.22*x.27)))
        z.1   = 'g'^(x.21*x.26*inv(x.27))
    
    47. gx    = x.19^(x.20*inv((x.21*x.22)))
        y     = (x.21*x.26*inv((x.20*x.27)))
        z     = x.19^(x.26*inv((x.22*x.27)))
        z.1   = 'g'^(x.21*x.26*inv((x.20*x.27)))
    
    48. gx    = x.20^(x.21*x.22*inv((x.23*x.24)))
        y     = (x.23*x.28*inv((x.21*x.29)))
        z     = x.20^(x.22*x.28*inv((x.24*x.29)))
        z.1   = 'g'^(x.23*x.28*inv((x.21*x.29)))
  */

rule (modulo E) A_4_recv:
   [
   St_A_4( A, B, idA, ka, pkb, x, gy, h(gy^x) ),
   In( <B, signb, mac(<'1', B>, h(gy^x)), pkb> )
   ]
  --[
  Eq( verify(signb, <'g'^x, gy>, pkb), true ),
  Commit( A, B, <'I', 'R', h(gy^x)> ), Secret( A, B, h(gy^x) ),
  Finish( A, B, 'I', 'g'^x, gy, h(gy^x) )
  ]->
   [ St_A_5( A, B, idA, ka, pkb, x, gy, h(gy^x) ) ]

  /*
  rule (modulo AC) A_4_recv:
     [
     St_A_4( A, B, idA, ka, pkb, x, gy, h(z) ),
     In( <B, signb, mac(<'1', B>, h(z)), pkb> )
     ]
    --[
    Eq( z.1, true ), Commit( A, B, <'I', 'R', h(z)> ),
    Secret( A, B, h(z) ), Finish( A, B, 'I', z.2, gy, h(z) )
    ]->
     [ St_A_5( A, B, idA, ka, pkb, x, gy, h(z) ) ]
    variants (modulo AC)
      1. gy    = gy.20
         pkb   = pkb.23
         signb = signb.24
         x     = one
         z     = gy.20
         z.1   = verify(signb.24, <'g', gy.20>, pkb.23)
         z.2   = 'g'
    
      2. gy    = gy.20
         pkb   = mac(<'g', gy.20>, signb.24)
         signb = signb.24
         x     = one
         z     = gy.20
         z.1   = true
         z.2   = 'g'
    
      3. gy    = gy.21
         pkb   = pkb.24
         signb = signb.25
         x     = x.26
         z     = gy.21^x.26
         z.1   = verify(signb.25, <'g'^x.26, gy.21>, pkb.24)
         z.2   = 'g'^x.26
    
      4. gy    = gy.21
         pkb   = mac(<'g'^x.26, gy.21>, signb.25)
         signb = signb.25
         x     = x.26
         z     = gy.21^x.26
         z.1   = true
         z.2   = 'g'^x.26
    
      5. gy    = gy.43
         pkb   = pk(x.82)
         signb = sign(<'g', gy.43>, x.82)
         x     = one
         z     = gy.43
         z.1   = true
         z.2   = 'g'
    
      6. gy    = gy.43
         pkb   = pk(x.82)
         signb = sign(<'g'^x.48, gy.43>, x.82)
         x     = x.48
         z     = gy.43^x.48
         z.1   = true
         z.2   = 'g'^x.48
    
      7. gy    = DH_neutral
         pkb   = pkb.18
         signb = signb.19
         x     = x.20
         z     = DH_neutral
         z.1   = verify(signb.19, <'g'^x.20, DH_neutral>, pkb.18)
         z.2   = 'g'^x.20
    
      8. gy    = DH_neutral
         pkb   = mac(<'g'^x.18, DH_neutral>, signb.17)
         signb = signb.17
         x     = x.18
         z     = DH_neutral
         z.1   = true
         z.2   = 'g'^x.18
    
      9. gy    = DH_neutral
         pkb   = pk(x.51)
         signb = sign(<'g'^x.30, DH_neutral>, x.51)
         x     = x.30
         z     = DH_neutral
         z.1   = true
         z.2   = 'g'^x.30
    
     10. gy    = z.20^inv(x.19)
         pkb   = mac(<'g'^x.19, z.20^inv(x.19)>, signb.18)
         signb = signb.18
         x     = x.19
         z     = z.20
         z.1   = true
         z.2   = 'g'^x.19
    
     11. gy    = x.21^x.22
         pkb   = pk(x.25)
         signb = sign(<'g'^inv((x.22*x.26)), x.21^x.22>, x.25)
         x     = inv((x.22*x.26))
         z     = x.21^inv(x.26)
         z.1   = true
         z.2   = 'g'^inv((x.22*x.26))
    
     12. gy    = x.21^x.22
         pkb   = pk(x.25)
         signb = sign(<'g'^(x.26*inv(x.22)), x.21^x.22>, x.25)
         x     = (x.26*inv(x.22))
         z     = x.21^x.26
         z.1   = true
         z.2   = 'g'^(x.26*inv(x.22))
    
     13. gy    = x.21^inv(x.22)
         pkb   = pk(x.25)
         signb = sign(<'g'^inv(x.26), x.21^inv(x.22)>, x.25)
         x     = inv(x.26)
         z     = x.21^inv((x.22*x.26))
         z.1   = true
         z.2   = 'g'^inv(x.26)
    
     14. gy    = x.21^inv(x.22)
         pkb   = pk(x.25)
         signb = sign(<'g'^(x.22*x.26), x.21^inv(x.22)>, x.25)
         x     = (x.22*x.26)
         z     = x.21^x.26
         z.1   = true
         z.2   = 'g'^(x.22*x.26)
    
     15. gy    = x.21^(x.22*x.23)
         pkb   = pk(x.26)
         signb = sign(<'g'^inv(x.22), x.21^(x.22*x.23)>, x.26)
         x     = inv(x.22)
         z     = x.21^x.23
         z.1   = true
         z.2   = 'g'^inv(x.22)
    
     16. gy    = x.22^x.23
         pkb   = pk(x.26)
         signb = sign(<'g'^(x.27*inv((x.23*x.28))), x.22^x.23>, x.26)
         x     = (x.27*inv((x.23*x.28)))
         z     = x.22^(x.27*inv(x.28))
         z.1   = true
         z.2   = 'g'^(x.27*inv((x.23*x.28)))
    
     17. gy    = x.22^inv(x.23)
         pkb   = pk(x.26)
         signb = sign(<'g'^(x.27*inv(x.28)), x.22^inv(x.23)>, x.26)
         x     = (x.27*inv(x.28))
         z     = x.22^(x.27*inv((x.23*x.28)))
         z.1   = true
         z.2   = 'g'^(x.27*inv(x.28))
    
     18. gy    = x.22^inv((x.23*x.24))
         pkb   = pk(x.27)
         signb = sign(<'g'^(x.23*x.28), x.22^inv((x.23*x.24))>, x.27)
         x     = (x.23*x.28)
         z     = x.22^(x.28*inv(x.24))
         z.1   = true
         z.2   = 'g'^(x.23*x.28)
    
     19. gy    = x.22^inv((x.23*x.24))
         pkb   = pk(x.27)
         signb = sign(<'g'^(x.23*inv(x.28)), x.22^inv((x.23*x.24))>, x.27)
         x     = (x.23*inv(x.28))
         z     = x.22^inv((x.24*x.28))
         z.1   = true
         z.2   = 'g'^(x.23*inv(x.28))
    
     20. gy    = x.22^(x.23*x.24)
         pkb   = pk(x.27)
         signb = sign(<'g'^inv((x.23*x.28)), x.22^(x.23*x.24)>, x.27)
         x     = inv((x.23*x.28))
         z     = x.22^(x.24*inv(x.28))
         z.1   = true
         z.2   = 'g'^inv((x.23*x.28))
    
     21. gy    = x.22^(x.23*x.24)
         pkb   = pk(x.27)
         signb = sign(<'g'^(x.28*inv(x.23)), x.22^(x.23*x.24)>, x.27)
         x     = (x.28*inv(x.23))
         z     = x.22^(x.24*x.28)
         z.1   = true
         z.2   = 'g'^(x.28*inv(x.23))
    
     22. gy    = x.22^(x.23*x.24*inv(x.25))
         pkb   = pk(x.28)
         signb = sign(<'g'^(x.25*inv(x.24)), x.22^(x.23*x.24*inv(x.25))>,
                      x.28)
         x     = (x.25*inv(x.24))
         z     = x.22^x.23
         z.1   = true
         z.2   = 'g'^(x.25*inv(x.24))
    
     23. gy    = x.22^(x.23*inv(x.24))
         pkb   = pk(x.27)
         signb = sign(<'g'^inv(x.28), x.22^(x.23*inv(x.24))>, x.27)
         x     = inv(x.28)
         z     = x.22^(x.23*inv((x.24*x.28)))
         z.1   = true
         z.2   = 'g'^inv(x.28)
    
     24. gy    = x.22^(x.23*inv(x.24))
         pkb   = pk(x.27)
         signb = sign(<'g'^inv((x.23*x.28)), x.22^(x.23*inv(x.24))>, x.27)
         x     = inv((x.23*x.28))
         z     = x.22^inv((x.24*x.28))
         z.1   = true
         z.2   = 'g'^inv((x.23*x.28))
    
     25. gy    = x.22^(x.23*inv(x.24))
         pkb   = pk(x.27)
         signb = sign(<'g'^(x.24*x.28), x.22^(x.23*inv(x.24))>, x.27)
         x     = (x.24*x.28)
         z     = x.22^(x.23*x.28)
         z.1   = true
         z.2   = 'g'^(x.24*x.28)
    
     26. gy    = x.22^(x.23*inv(x.24))
         pkb   = pk(x.27)
         signb = sign(<'g'^(x.24*x.28*inv(x.23)), x.22^(x.23*inv(x.24))>,
                      x.27)
         x     = (x.24*x.28*inv(x.23))
         z     = x.22^x.28
         z.1   = true
         z.2   = 'g'^(x.24*x.28*inv(x.23))
    
     27. gy    = x.22^(x.23*inv(x.24))
         pkb   = pk(x.27)
         signb = sign(<'g'^(x.24*inv((x.23*x.28))), x.22^(x.23*inv(x.24))>,
                      x.27)
         x     = (x.24*inv((x.23*x.28)))
         z     = x.22^inv(x.28)
         z.1   = true
         z.2   = 'g'^(x.24*inv((x.23*x.28)))
    
     28. gy    = x.22^(x.23*inv((x.24*x.25)))
         pkb   = pk(x.28)
         signb = sign(<'g'^(x.25*inv(x.23)), x.22^(x.23*inv((x.24*x.25)))>,
                      x.28)
         x     = (x.25*inv(x.23))
         z     = x.22^inv(x.24)
         z.1   = true
         z.2   = 'g'^(x.25*inv(x.23))
    
     29. gy    = z.22^inv(x.21)
         pkb   = pkb.19
         signb = signb.20
         x     = x.21
         z     = z.22
         z.1   = verify(signb.20, <'g'^x.21, z.22^inv(x.21)>, pkb.19)
         z.2   = 'g'^x.21
    
     30. gy    = x.23^inv((x.24*x.25))
         pkb   = pk(x.28)
         signb = sign(<'g'^(x.24*x.29*inv(x.30)), x.23^inv((x.24*x.25))>,
                      x.28)
         x     = (x.24*x.29*inv(x.30))
         z     = x.23^(x.29*inv((x.25*x.30)))
         z.1   = true
         z.2   = 'g'^(x.24*x.29*inv(x.30))
    
     31. gy    = x.23^(x.24*x.25)
         pkb   = pk(x.28)
         signb = sign(<'g'^(x.29*inv((x.24*x.30))), x.23^(x.24*x.25)>, x.28)
         x     = (x.29*inv((x.24*x.30)))
         z     = x.23^(x.25*x.29*inv(x.30))
         z.1   = true
         z.2   = 'g'^(x.29*inv((x.24*x.30)))
    
     32. gy    = x.23^(x.24*x.25*inv(x.26))
         pkb   = pk(x.29)
         signb = sign(<'g'^inv((x.25*x.30)), x.23^(x.24*x.25*inv(x.26))>,
                      x.29)
         x     = inv((x.25*x.30))
         z     = x.23^(x.24*inv((x.26*x.30)))
         z.1   = true
         z.2   = 'g'^inv((x.25*x.30))
    
     33. gy    = x.23^(x.24*x.25*inv(x.26))
         pkb   = pk(x.29)
         signb = sign(<'g'^(x.26*x.30*inv(x.24)), x.23^(x.24*x.25*inv(x.26))
                      >,
                      x.29)
         x     = (x.26*x.30*inv(x.24))
         z     = x.23^(x.25*x.30)
         z.1   = true
         z.2   = 'g'^(x.26*x.30*inv(x.24))
    
     34. gy    = x.23^(x.24*x.25*inv(x.26))
         pkb   = pk(x.29)
         signb = sign(<'g'^(x.26*inv((x.24*x.30))), 
                       x.23^(x.24*x.25*inv(x.26))>,
                      x.29)
         x     = (x.26*inv((x.24*x.30)))
         z     = x.23^(x.25*inv(x.30))
         z.1   = true
         z.2   = 'g'^(x.26*inv((x.24*x.30)))
    
     35. gy    = x.23^(x.24*x.25*inv((x.26*x.27)))
         pkb   = pk(x.30)
         signb = sign(<'g'^(x.27*inv(x.25)), 
                       x.23^(x.24*x.25*inv((x.26*x.27)))>,
                      x.30)
         x     = (x.27*inv(x.25))
         z     = x.23^(x.24*inv(x.26))
         z.1   = true
         z.2   = 'g'^(x.27*inv(x.25))
    
     36. gy    = x.23^(x.24*inv(x.25))
         pkb   = pk(x.28)
         signb = sign(<'g'^(x.25*x.29*inv((x.24*x.30))), 
                       x.23^(x.24*inv(x.25))>,
                      x.28)
         x     = (x.25*x.29*inv((x.24*x.30)))
         z     = x.23^(x.29*inv(x.30))
         z.1   = true
         z.2   = 'g'^(x.25*x.29*inv((x.24*x.30)))
    
     37. gy    = x.23^(x.24*inv(x.25))
         pkb   = pk(x.28)
         signb = sign(<'g'^(x.29*inv(x.30)), x.23^(x.24*inv(x.25))>, x.28)
         x     = (x.29*inv(x.30))
         z     = x.23^(x.24*x.29*inv((x.25*x.30)))
         z.1   = true
         z.2   = 'g'^(x.29*inv(x.30))
    
     38. gy    = x.23^(x.24*inv(x.25))
         pkb   = pk(x.28)
         signb = sign(<'g'^(x.29*inv((x.24*x.30))), x.23^(x.24*inv(x.25))>,
                      x.28)
         x     = (x.29*inv((x.24*x.30)))
         z     = x.23^(x.29*inv((x.25*x.30)))
         z.1   = true
         z.2   = 'g'^(x.29*inv((x.24*x.30)))
    
     39. gy    = x.23^(x.24*inv((x.25*x.26)))
         pkb   = pk(x.29)
         signb = sign(<'g'^(x.25*x.30), x.23^(x.24*inv((x.25*x.26)))>, x.29)
         x     = (x.25*x.30)
         z     = x.23^(x.24*x.30*inv(x.26))
         z.1   = true
         z.2   = 'g'^(x.25*x.30)
    
     40. gy    = x.23^(x.24*inv((x.25*x.26)))
         pkb   = pk(x.29)
         signb = sign(<'g'^(x.25*x.30*inv(x.24)), 
                       x.23^(x.24*inv((x.25*x.26)))>,
                      x.29)
         x     = (x.25*x.30*inv(x.24))
         z     = x.23^(x.30*inv(x.26))
         z.1   = true
         z.2   = 'g'^(x.25*x.30*inv(x.24))
    
     41. gy    = x.23^(x.24*inv((x.25*x.26)))
         pkb   = pk(x.29)
         signb = sign(<'g'^(x.25*inv(x.30)), x.23^(x.24*inv((x.25*x.26)))>,
                      x.29)
         x     = (x.25*inv(x.30))
         z     = x.23^(x.24*inv((x.26*x.30)))
         z.1   = true
         z.2   = 'g'^(x.25*inv(x.30))
    
     42. gy    = x.23^(x.24*inv((x.25*x.26)))
         pkb   = pk(x.29)
         signb = sign(<'g'^(x.25*inv((x.24*x.30))), 
                       x.23^(x.24*inv((x.25*x.26)))>,
                      x.29)
         x     = (x.25*inv((x.24*x.30)))
         z     = x.23^inv((x.26*x.30))
         z.1   = true
         z.2   = 'g'^(x.25*inv((x.24*x.30)))
    
     43. gy    = x.24^(x.25*x.26*inv(x.27))
         pkb   = pk(x.30)
         signb = sign(<'g'^(x.27*x.31*inv((x.25*x.32))), 
                       x.24^(x.25*x.26*inv(x.27))>,
                      x.30)
         x     = (x.27*x.31*inv((x.25*x.32)))
         z     = x.24^(x.26*x.31*inv(x.32))
         z.1   = true
         z.2   = 'g'^(x.27*x.31*inv((x.25*x.32)))
    
     44. gy    = x.24^(x.25*x.26*inv(x.27))
         pkb   = pk(x.30)
         signb = sign(<'g'^(x.31*inv((x.25*x.32))), 
                       x.24^(x.25*x.26*inv(x.27))>,
                      x.30)
         x     = (x.31*inv((x.25*x.32)))
         z     = x.24^(x.26*x.31*inv((x.27*x.32)))
         z.1   = true
         z.2   = 'g'^(x.31*inv((x.25*x.32)))
    
     45. gy    = x.24^(x.25*x.26*inv((x.27*x.28)))
         pkb   = pk(x.31)
         signb = sign(<'g'^(x.27*x.32*inv(x.25)), 
                       x.24^(x.25*x.26*inv((x.27*x.28)))>,
                      x.31)
         x     = (x.27*x.32*inv(x.25))
         z     = x.24^(x.26*x.32*inv(x.28))
         z.1   = true
         z.2   = 'g'^(x.27*x.32*inv(x.25))
    
     46. gy    = x.24^(x.25*x.26*inv((x.27*x.28)))
         pkb   = pk(x.31)
         signb = sign(<'g'^(x.27*inv((x.25*x.32))), 
                       x.24^(x.25*x.26*inv((x.27*x.28)))>,
                      x.31)
         x     = (x.27*inv((x.25*x.32)))
         z     = x.24^(x.26*inv((x.28*x.32)))
         z.1   = true
         z.2   = 'g'^(x.27*inv((x.25*x.32)))
    
     47. gy    = x.24^(x.25*inv((x.26*x.27)))
         pkb   = pk(x.30)
         signb = sign(<'g'^(x.26*x.31*inv(x.32)), 
                       x.24^(x.25*inv((x.26*x.27)))>,
                      x.30)
         x     = (x.26*x.31*inv(x.32))
         z     = x.24^(x.25*x.31*inv((x.27*x.32)))
         z.1   = true
         z.2   = 'g'^(x.26*x.31*inv(x.32))
    
     48. gy    = x.24^(x.25*inv((x.26*x.27)))
         pkb   = pk(x.30)
         signb = sign(<'g'^(x.26*x.31*inv((x.25*x.32))), 
                       x.24^(x.25*inv((x.26*x.27)))>,
                      x.30)
         x     = (x.26*x.31*inv((x.25*x.32)))
         z     = x.24^(x.31*inv((x.27*x.32)))
         z.1   = true
         z.2   = 'g'^(x.26*x.31*inv((x.25*x.32)))
    
     49. gy    = x.25^(x.26*x.27*inv((x.28*x.29)))
         pkb   = pk(x.32)
         signb = sign(<'g'^(x.28*x.33*inv((x.26*x.34))), 
                       x.25^(x.26*x.27*inv((x.28*x.29)))>,
                      x.32)
         x     = (x.28*x.33*inv((x.26*x.34)))
         z     = x.25^(x.27*x.33*inv((x.29*x.34)))
         z.1   = true
         z.2   = 'g'^(x.28*x.33*inv((x.26*x.34)))
    
     50. gy    = z.32^x.51
         pkb   = pk(x.54)
         signb = sign(<'g'^inv(x.51), z.32^x.51>, x.54)
         x     = inv(x.51)
         z     = z.32
         z.1   = true
         z.2   = 'g'^inv(x.51)
    
     51. gy    = z.33^(x.52*inv(x.53))
         pkb   = pk(x.56)
         signb = sign(<'g'^(x.53*inv(x.52)), z.33^(x.52*inv(x.53))>, x.56)
         x     = (x.53*inv(x.52))
         z     = z.33
         z.1   = true
         z.2   = 'g'^(x.53*inv(x.52))
    
     52. gy    = z.35^x.58
         pkb   = mac(<'g'^inv(x.58), z.35^x.58>, signb.33)
         signb = signb.33
         x     = inv(x.58)
         z     = z.35
         z.1   = true
         z.2   = 'g'^inv(x.58)
    
     53. gy    = z.35^inv(x.34)
         pkb   = pk(x.59)
         signb = sign(<'g'^x.34, z.35^inv(x.34)>, x.59)
         x     = x.34
         z     = z.35
         z.1   = true
         z.2   = 'g'^x.34
    
     54. gy    = z.36^(x.59*inv(x.60))
         pkb   = mac(<'g'^(x.60*inv(x.59)), z.36^(x.59*inv(x.60))>,
                     signb.34)
         signb = signb.34
         x     = (x.60*inv(x.59))
         z     = z.36
         z.1   = true
         z.2   = 'g'^(x.60*inv(x.59))
    
     55. gy    = z.38^x.63
         pkb   = pkb.35
         signb = signb.36
         x     = inv(x.63)
         z     = z.38
         z.1   = verify(signb.36, <'g'^inv(x.63), z.38^x.63>, pkb.35)
         z.2   = 'g'^inv(x.63)
    
     56. gy    = z.39^(x.64*inv(x.65))
         pkb   = pkb.36
         signb = signb.37
         x     = (x.65*inv(x.64))
         z     = z.39
         z.1   = verify(signb.37,
                        <'g'^(x.65*inv(x.64)), z.39^(x.64*inv(x.65))>, pkb.36)
         z.2   = 'g'^(x.65*inv(x.64))
    
     57. gy    = x.55^x.56
         pkb   = pk(x.59)
         signb = sign(<'g'^x.34, x.55^x.56>, x.59)
         x     = x.34
         z     = x.55^(x.34*x.56)
         z.1   = true
         z.2   = 'g'^x.34
    
     58. gy    = x.56^inv((x.35*x.57))
         pkb   = pk(x.61)
         signb = sign(<'g'^x.35, x.56^inv((x.35*x.57))>, x.61)
         x     = x.35
         z     = x.56^inv(x.57)
         z.1   = true
         z.2   = 'g'^x.35
    
     59. gy    = x.56^(x.57*inv(x.35))
         pkb   = pk(x.61)
         signb = sign(<'g'^x.35, x.56^(x.57*inv(x.35))>, x.61)
         x     = x.35
         z     = x.56^x.57
         z.1   = true
         z.2   = 'g'^x.35
    
     60. gy    = x.57^x.58
         pkb   = mac(<'g'^x.34, x.57^x.58>, signb.33)
         signb = signb.33
         x     = x.34
         z     = x.57^(x.34*x.58)
         z.1   = true
         z.2   = 'g'^x.34
    
     61. gy    = x.57^inv((x.34*x.58))
         pkb   = mac(<'g'^x.34, x.57^inv((x.34*x.58))>, signb.33)
         signb = signb.33
         x     = x.34
         z     = x.57^inv(x.58)
         z.1   = true
         z.2   = 'g'^x.34
    
     62. gy    = x.57^(x.58*inv(x.34))
         pkb   = mac(<'g'^x.34, x.57^(x.58*inv(x.34))>, signb.33)
         signb = signb.33
         x     = x.34
         z     = x.57^x.58
         z.1   = true
         z.2   = 'g'^x.34
    
     63. gy    = x.57^(x.58*inv((x.36*x.59)))
         pkb   = pk(x.63)
         signb = sign(<'g'^x.36, x.57^(x.58*inv((x.36*x.59)))>, x.63)
         x     = x.36
         z     = x.57^(x.58*inv(x.59))
         z.1   = true
         z.2   = 'g'^x.36
    
     64. gy    = x.58^(x.59*x.60)
         pkb   = mac(<'g'^inv(x.59), x.58^(x.59*x.60)>, signb.34)
         signb = signb.34
         x     = inv(x.59)
         z     = x.58^x.60
         z.1   = true
         z.2   = 'g'^inv(x.59)
    
     65. gy    = x.58^(x.59*inv((x.35*x.60)))
         pkb   = mac(<'g'^x.35, x.58^(x.59*inv((x.35*x.60)))>, signb.34)
         signb = signb.34
         x     = x.35
         z     = x.58^(x.59*inv(x.60))
         z.1   = true
         z.2   = 'g'^x.35
    
     66. gy    = x.59^(x.60*x.61*inv(x.62))
         pkb   = mac(<'g'^(x.62*inv(x.61)), x.59^(x.60*x.61*inv(x.62))>,
                     signb.35)
         signb = signb.35
         x     = (x.62*inv(x.61))
         z     = x.59^x.60
         z.1   = true
         z.2   = 'g'^(x.62*inv(x.61))
    
     67. gy    = x.59^(x.60*inv((x.61*x.62)))
         pkb   = mac(<'g'^(x.62*inv(x.60)), x.59^(x.60*inv((x.61*x.62)))>,
                     signb.35)
         signb = signb.35
         x     = (x.62*inv(x.60))
         z     = x.59^inv(x.61)
         z.1   = true
         z.2   = 'g'^(x.62*inv(x.60))
    
     68. gy    = x.60^x.61
         pkb   = mac(<'g'^inv((x.61*x.64)), x.60^x.61>, signb.36)
         signb = signb.36
         x     = inv((x.61*x.64))
         z     = x.60^inv(x.64)
         z.1   = true
         z.2   = 'g'^inv((x.61*x.64))
    
     69. gy    = x.60^x.61
         pkb   = mac(<'g'^(x.64*inv(x.61)), x.60^x.61>, signb.36)
         signb = signb.36
         x     = (x.64*inv(x.61))
         z     = x.60^x.64
         z.1   = true
         z.2   = 'g'^(x.64*inv(x.61))
    
     70. gy    = x.60^inv(x.61)
         pkb   = mac(<'g'^inv(x.64), x.60^inv(x.61)>, signb.36)
         signb = signb.36
         x     = inv(x.64)
         z     = x.60^inv((x.61*x.64))
         z.1   = true
         z.2   = 'g'^inv(x.64)
    
     71. gy    = x.60^inv(x.61)
         pkb   = mac(<'g'^(x.61*x.64), x.60^inv(x.61)>, signb.36)
         signb = signb.36
         x     = (x.61*x.64)
         z     = x.60^x.64
         z.1   = true
         z.2   = 'g'^(x.61*x.64)
    
     72. gy    = x.60^(x.61*x.62*inv((x.63*x.64)))
         pkb   = mac(<'g'^(x.64*inv(x.62)), 
                      x.60^(x.61*x.62*inv((x.63*x.64)))>,
                     signb.36)
         signb = signb.36
         x     = (x.64*inv(x.62))
         z     = x.60^(x.61*inv(x.63))
         z.1   = true
         z.2   = 'g'^(x.64*inv(x.62))
    
     73. gy    = x.61^x.62
         pkb   = mac(<'g'^(x.65*inv((x.62*x.66))), x.61^x.62>, signb.37)
         signb = signb.37
         x     = (x.65*inv((x.62*x.66)))
         z     = x.61^(x.65*inv(x.66))
         z.1   = true
         z.2   = 'g'^(x.65*inv((x.62*x.66)))
    
     74. gy    = x.61^inv(x.62)
         pkb   = mac(<'g'^(x.65*inv(x.66)), x.61^inv(x.62)>, signb.37)
         signb = signb.37
         x     = (x.65*inv(x.66))
         z     = x.61^(x.65*inv((x.62*x.66)))
         z.1   = true
         z.2   = 'g'^(x.65*inv(x.66))
    
     75. gy    = x.61^inv((x.62*x.63))
         pkb   = mac(<'g'^(x.62*x.66), x.61^inv((x.62*x.63))>, signb.37)
         signb = signb.37
         x     = (x.62*x.66)
         z     = x.61^(x.66*inv(x.63))
         z.1   = true
         z.2   = 'g'^(x.62*x.66)
    
     76. gy    = x.61^inv((x.62*x.63))
         pkb   = mac(<'g'^(x.62*inv(x.66)), x.61^inv((x.62*x.63))>,
                     signb.37)
         signb = signb.37
         x     = (x.62*inv(x.66))
         z     = x.61^inv((x.63*x.66))
         z.1   = true
         z.2   = 'g'^(x.62*inv(x.66))
    
     77. gy    = x.61^(x.62*x.63)
         pkb   = mac(<'g'^inv((x.62*x.66)), x.61^(x.62*x.63)>, signb.37)
         signb = signb.37
         x     = inv((x.62*x.66))
         z     = x.61^(x.63*inv(x.66))
         z.1   = true
         z.2   = 'g'^inv((x.62*x.66))
    
     78. gy    = x.61^(x.62*x.63)
         pkb   = mac(<'g'^(x.66*inv(x.62)), x.61^(x.62*x.63)>, signb.37)
         signb = signb.37
         x     = (x.66*inv(x.62))
         z     = x.61^(x.63*x.66)
         z.1   = true
         z.2   = 'g'^(x.66*inv(x.62))
    
     79. gy    = x.61^(x.62*inv(x.63))
         pkb   = mac(<'g'^inv(x.66), x.61^(x.62*inv(x.63))>, signb.37)
         signb = signb.37
         x     = inv(x.66)
         z     = x.61^(x.62*inv((x.63*x.66)))
         z.1   = true
         z.2   = 'g'^inv(x.66)
    
     80. gy    = x.61^(x.62*inv(x.63))
         pkb   = mac(<'g'^inv((x.62*x.66)), x.61^(x.62*inv(x.63))>,
                     signb.37)
         signb = signb.37
         x     = inv((x.62*x.66))
         z     = x.61^inv((x.63*x.66))
         z.1   = true
         z.2   = 'g'^inv((x.62*x.66))
    
     81. gy    = x.61^(x.62*inv(x.63))
         pkb   = mac(<'g'^(x.63*x.66), x.61^(x.62*inv(x.63))>, signb.37)
         signb = signb.37
         x     = (x.63*x.66)
         z     = x.61^(x.62*x.66)
         z.1   = true
         z.2   = 'g'^(x.63*x.66)
    
     82. gy    = x.61^(x.62*inv(x.63))
         pkb   = mac(<'g'^(x.63*x.66*inv(x.62)), x.61^(x.62*inv(x.63))>,
                     signb.37)
         signb = signb.37
         x     = (x.63*x.66*inv(x.62))
         z     = x.61^x.66
         z.1   = true
         z.2   = 'g'^(x.63*x.66*inv(x.62))
    
     83. gy    = x.61^(x.62*inv(x.63))
         pkb   = mac(<'g'^(x.63*inv((x.62*x.66))), x.61^(x.62*inv(x.63))>,
                     signb.37)
         signb = signb.37
         x     = (x.63*inv((x.62*x.66)))
         z     = x.61^inv(x.66)
         z.1   = true
         z.2   = 'g'^(x.63*inv((x.62*x.66)))
    
     84. gy    = x.62^x.63
         pkb   = pkb.35
         signb = signb.36
         x     = x.37
         z     = x.62^(x.37*x.63)
         z.1   = verify(signb.36, <'g'^x.37, x.62^x.63>, pkb.35)
         z.2   = 'g'^x.37
    
     85. gy    = x.62^inv((x.37*x.63))
         pkb   = pkb.35
         signb = signb.36
         x     = x.37
         z     = x.62^inv(x.63)
         z.1   = verify(signb.36, <'g'^x.37, x.62^inv((x.37*x.63))>, pkb.35)
         z.2   = 'g'^x.37
    
     86. gy    = x.62^inv((x.63*x.64))
         pkb   = mac(<'g'^(x.63*x.67*inv(x.68)), x.62^inv((x.63*x.64))>,
                     signb.38)
         signb = signb.38
         x     = (x.63*x.67*inv(x.68))
         z     = x.62^(x.67*inv((x.64*x.68)))
         z.1   = true
         z.2   = 'g'^(x.63*x.67*inv(x.68))
    
     87. gy    = x.62^(x.63*x.64)
         pkb   = mac(<'g'^(x.67*inv((x.63*x.68))), x.62^(x.63*x.64)>,
                     signb.38)
         signb = signb.38
         x     = (x.67*inv((x.63*x.68)))
         z     = x.62^(x.64*x.67*inv(x.68))
         z.1   = true
         z.2   = 'g'^(x.67*inv((x.63*x.68)))
    
     88. gy    = x.62^(x.63*x.64*inv(x.65))
         pkb   = mac(<'g'^inv((x.64*x.68)), x.62^(x.63*x.64*inv(x.65))>,
                     signb.38)
         signb = signb.38
         x     = inv((x.64*x.68))
         z     = x.62^(x.63*inv((x.65*x.68)))
         z.1   = true
         z.2   = 'g'^inv((x.64*x.68))
    
     89. gy    = x.62^(x.63*x.64*inv(x.65))
         pkb   = mac(<'g'^(x.65*x.68*inv(x.63)), x.62^(x.63*x.64*inv(x.65))
                     >,
                     signb.38)
         signb = signb.38
         x     = (x.65*x.68*inv(x.63))
         z     = x.62^(x.64*x.68)
         z.1   = true
         z.2   = 'g'^(x.65*x.68*inv(x.63))
    
     90. gy    = x.62^(x.63*x.64*inv(x.65))
         pkb   = mac(<'g'^(x.65*inv((x.63*x.68))), 
                      x.62^(x.63*x.64*inv(x.65))>,
                     signb.38)
         signb = signb.38
         x     = (x.65*inv((x.63*x.68)))
         z     = x.62^(x.64*inv(x.68))
         z.1   = true
         z.2   = 'g'^(x.65*inv((x.63*x.68)))
    
     91. gy    = x.62^(x.63*inv(x.37))
         pkb   = pkb.35
         signb = signb.36
         x     = x.37
         z     = x.62^x.63
         z.1   = verify(signb.36, <'g'^x.37, x.62^(x.63*inv(x.37))>, pkb.35)
         z.2   = 'g'^x.37
    
     92. gy    = x.62^(x.63*inv(x.64))
         pkb   = mac(<'g'^(x.64*x.67*inv((x.63*x.68))), 
                      x.62^(x.63*inv(x.64))>,
                     signb.38)
         signb = signb.38
         x     = (x.64*x.67*inv((x.63*x.68)))
         z     = x.62^(x.67*inv(x.68))
         z.1   = true
         z.2   = 'g'^(x.64*x.67*inv((x.63*x.68)))
    
     93. gy    = x.62^(x.63*inv(x.64))
         pkb   = mac(<'g'^(x.67*inv(x.68)), x.62^(x.63*inv(x.64))>,
                     signb.38)
         signb = signb.38
         x     = (x.67*inv(x.68))
         z     = x.62^(x.63*x.67*inv((x.64*x.68)))
         z.1   = true
         z.2   = 'g'^(x.67*inv(x.68))
    
     94. gy    = x.62^(x.63*inv(x.64))
         pkb   = mac(<'g'^(x.67*inv((x.63*x.68))), x.62^(x.63*inv(x.64))>,
                     signb.38)
         signb = signb.38
         x     = (x.67*inv((x.63*x.68)))
         z     = x.62^(x.67*inv((x.64*x.68)))
         z.1   = true
         z.2   = 'g'^(x.67*inv((x.63*x.68)))
    
     95. gy    = x.62^(x.63*inv((x.64*x.65)))
         pkb   = mac(<'g'^(x.64*x.68), x.62^(x.63*inv((x.64*x.65)))>,
                     signb.38)
         signb = signb.38
         x     = (x.64*x.68)
         z     = x.62^(x.63*x.68*inv(x.65))
         z.1   = true
         z.2   = 'g'^(x.64*x.68)
    
     96. gy    = x.62^(x.63*inv((x.64*x.65)))
         pkb   = mac(<'g'^(x.64*x.68*inv(x.63)), 
                      x.62^(x.63*inv((x.64*x.65)))>,
                     signb.38)
         signb = signb.38
         x     = (x.64*x.68*inv(x.63))
         z     = x.62^(x.68*inv(x.65))
         z.1   = true
         z.2   = 'g'^(x.64*x.68*inv(x.63))
    
     97. gy    = x.62^(x.63*inv((x.64*x.65)))
         pkb   = mac(<'g'^(x.64*inv(x.68)), x.62^(x.63*inv((x.64*x.65)))>,
                     signb.38)
         signb = signb.38
         x     = (x.64*inv(x.68))
         z     = x.62^(x.63*inv((x.65*x.68)))
         z.1   = true
         z.2   = 'g'^(x.64*inv(x.68))
    
     98. gy    = x.62^(x.63*inv((x.64*x.65)))
         pkb   = mac(<'g'^(x.64*inv((x.63*x.68))), 
                      x.62^(x.63*inv((x.64*x.65)))>,
                     signb.38)
         signb = signb.38
         x     = (x.64*inv((x.63*x.68)))
         z     = x.62^inv((x.65*x.68))
         z.1   = true
         z.2   = 'g'^(x.64*inv((x.63*x.68)))
    
     99. gy    = x.63^(x.64*x.65)
         pkb   = pkb.36
         signb = signb.37
         x     = inv(x.64)
         z     = x.63^x.65
         z.1   = verify(signb.37, <'g'^inv(x.64), x.63^(x.64*x.65)>, pkb.36)
         z.2   = 'g'^inv(x.64)
    
    100. gy    = x.63^(x.64*x.65*inv(x.66))
         pkb   = mac(<'g'^(x.66*x.69*inv((x.64*x.70))), 
                      x.63^(x.64*x.65*inv(x.66))>,
                     signb.39)
         signb = signb.39
         x     = (x.66*x.69*inv((x.64*x.70)))
         z     = x.63^(x.65*x.69*inv(x.70))
         z.1   = true
         z.2   = 'g'^(x.66*x.69*inv((x.64*x.70)))
    
    101. gy    = x.63^(x.64*x.65*inv(x.66))
         pkb   = mac(<'g'^(x.69*inv((x.64*x.70))), 
                      x.63^(x.64*x.65*inv(x.66))>,
                     signb.39)
         signb = signb.39
         x     = (x.69*inv((x.64*x.70)))
         z     = x.63^(x.65*x.69*inv((x.66*x.70)))
         z.1   = true
         z.2   = 'g'^(x.69*inv((x.64*x.70)))
    
    102. gy    = x.63^(x.64*x.65*inv((x.66*x.67)))
         pkb   = mac(<'g'^(x.66*x.70*inv(x.64)), 
                      x.63^(x.64*x.65*inv((x.66*x.67)))>,
                     signb.39)
         signb = signb.39
         x     = (x.66*x.70*inv(x.64))
         z     = x.63^(x.65*x.70*inv(x.67))
         z.1   = true
         z.2   = 'g'^(x.66*x.70*inv(x.64))
    
    103. gy    = x.63^(x.64*x.65*inv((x.66*x.67)))
         pkb   = mac(<'g'^(x.66*inv((x.64*x.70))), 
                      x.63^(x.64*x.65*inv((x.66*x.67)))>,
                     signb.39)
         signb = signb.39
         x     = (x.66*inv((x.64*x.70)))
         z     = x.63^(x.65*inv((x.67*x.70)))
         z.1   = true
         z.2   = 'g'^(x.66*inv((x.64*x.70)))
    
    104. gy    = x.63^(x.64*inv((x.38*x.65)))
         pkb   = pkb.36
         signb = signb.37
         x     = x.38
         z     = x.63^(x.64*inv(x.65))
         z.1   = verify(signb.37, <'g'^x.38, x.63^(x.64*inv((x.38*x.65)))>,
                        pkb.36)
         z.2   = 'g'^x.38
    
    105. gy    = x.63^(x.64*inv((x.65*x.66)))
         pkb   = mac(<'g'^(x.65*x.69*inv(x.70)), 
                      x.63^(x.64*inv((x.65*x.66)))>,
                     signb.39)
         signb = signb.39
         x     = (x.65*x.69*inv(x.70))
         z     = x.63^(x.64*x.69*inv((x.66*x.70)))
         z.1   = true
         z.2   = 'g'^(x.65*x.69*inv(x.70))
    
    106. gy    = x.63^(x.64*inv((x.65*x.66)))
         pkb   = mac(<'g'^(x.65*x.69*inv((x.64*x.70))), 
                      x.63^(x.64*inv((x.65*x.66)))>,
                     signb.39)
         signb = signb.39
         x     = (x.65*x.69*inv((x.64*x.70)))
         z     = x.63^(x.69*inv((x.66*x.70)))
         z.1   = true
         z.2   = 'g'^(x.65*x.69*inv((x.64*x.70)))
    
    107. gy    = x.64^(x.65*x.66*inv(x.67))
         pkb   = pkb.37
         signb = signb.38
         x     = (x.67*inv(x.66))
         z     = x.64^x.65
         z.1   = verify(signb.38,
                        <'g'^(x.67*inv(x.66)), x.64^(x.65*x.66*inv(x.67))>, pkb.37)
         z.2   = 'g'^(x.67*inv(x.66))
    
    108. gy    = x.64^(x.65*x.66*inv((x.67*x.68)))
         pkb   = mac(<'g'^(x.67*x.71*inv((x.65*x.72))), 
                      x.64^(x.65*x.66*inv((x.67*x.68)))>,
                     signb.40)
         signb = signb.40
         x     = (x.67*x.71*inv((x.65*x.72)))
         z     = x.64^(x.66*x.71*inv((x.68*x.72)))
         z.1   = true
         z.2   = 'g'^(x.67*x.71*inv((x.65*x.72)))
    
    109. gy    = x.64^(x.65*inv((x.66*x.67)))
         pkb   = pkb.37
         signb = signb.38
         x     = (x.67*inv(x.65))
         z     = x.64^inv(x.66)
         z.1   = verify(signb.38,
                        <'g'^(x.67*inv(x.65)), x.64^(x.65*inv((x.66*x.67)))>, pkb.37)
         z.2   = 'g'^(x.67*inv(x.65))
    
    110. gy    = x.65^(x.66*x.67*inv((x.68*x.69)))
         pkb   = pkb.38
         signb = signb.39
         x     = (x.69*inv(x.67))
         z     = x.65^(x.66*inv(x.68))
         z.1   = verify(signb.39,
                        <'g'^(x.69*inv(x.67)), x.65^(x.66*x.67*inv((x.68*x.69)))>, pkb.38)
         z.2   = 'g'^(x.69*inv(x.67))
    
    111. gy    = x.67^x.68
         pkb   = pkb.40
         signb = signb.41
         x     = inv((x.68*x.73))
         z     = x.67^inv(x.73)
         z.1   = verify(signb.41, <'g'^inv((x.68*x.73)), x.67^x.68>, pkb.40)
         z.2   = 'g'^inv((x.68*x.73))
    
    112. gy    = x.67^x.68
         pkb   = pkb.40
         signb = signb.41
         x     = (x.73*inv(x.68))
         z     = x.67^x.73
         z.1   = verify(signb.41, <'g'^(x.73*inv(x.68)), x.67^x.68>, pkb.40)
         z.2   = 'g'^(x.73*inv(x.68))
    
    113. gy    = x.67^inv(x.68)
         pkb   = pkb.40
         signb = signb.41
         x     = inv(x.73)
         z     = x.67^inv((x.68*x.73))
         z.1   = verify(signb.41, <'g'^inv(x.73), x.67^inv(x.68)>, pkb.40)
         z.2   = 'g'^inv(x.73)
    
    114. gy    = x.67^inv(x.68)
         pkb   = pkb.40
         signb = signb.41
         x     = (x.68*x.73)
         z     = x.67^x.73
         z.1   = verify(signb.41, <'g'^(x.68*x.73), x.67^inv(x.68)>, pkb.40)
         z.2   = 'g'^(x.68*x.73)
    
    115. gy    = x.68^x.69
         pkb   = pkb.41
         signb = signb.42
         x     = (x.74*inv((x.69*x.75)))
         z     = x.68^(x.74*inv(x.75))
         z.1   = verify(signb.42, <'g'^(x.74*inv((x.69*x.75))), x.68^x.69>,
                        pkb.41)
         z.2   = 'g'^(x.74*inv((x.69*x.75)))
    
    116. gy    = x.68^inv(x.69)
         pkb   = pkb.41
         signb = signb.42
         x     = (x.74*inv(x.75))
         z     = x.68^(x.74*inv((x.69*x.75)))
         z.1   = verify(signb.42, <'g'^(x.74*inv(x.75)), x.68^inv(x.69)>,
                        pkb.41)
         z.2   = 'g'^(x.74*inv(x.75))
    
    117. gy    = x.68^inv((x.69*x.70))
         pkb   = pkb.41
         signb = signb.42
         x     = (x.69*x.75)
         z     = x.68^(x.75*inv(x.70))
         z.1   = verify(signb.42, <'g'^(x.69*x.75), x.68^inv((x.69*x.70))>,
                        pkb.41)
         z.2   = 'g'^(x.69*x.75)
    
    118. gy    = x.68^inv((x.69*x.70))
         pkb   = pkb.41
         signb = signb.42
         x     = (x.69*inv(x.75))
         z     = x.68^inv((x.70*x.75))
         z.1   = verify(signb.42,
                        <'g'^(x.69*inv(x.75)), x.68^inv((x.69*x.70))>, pkb.41)
         z.2   = 'g'^(x.69*inv(x.75))
    
    119. gy    = x.68^(x.69*x.70)
         pkb   = pkb.41
         signb = signb.42
         x     = inv((x.69*x.75))
         z     = x.68^(x.70*inv(x.75))
         z.1   = verify(signb.42, <'g'^inv((x.69*x.75)), x.68^(x.69*x.70)>,
                        pkb.41)
         z.2   = 'g'^inv((x.69*x.75))
    
    120. gy    = x.68^(x.69*x.70)
         pkb   = pkb.41
         signb = signb.42
         x     = (x.75*inv(x.69))
         z     = x.68^(x.70*x.75)
         z.1   = verify(signb.42, <'g'^(x.75*inv(x.69)), x.68^(x.69*x.70)>,
                        pkb.41)
         z.2   = 'g'^(x.75*inv(x.69))
    
    121. gy    = x.68^(x.69*inv(x.70))
         pkb   = pkb.41
         signb = signb.42
         x     = inv(x.75)
         z     = x.68^(x.69*inv((x.70*x.75)))
         z.1   = verify(signb.42, <'g'^inv(x.75), x.68^(x.69*inv(x.70))>,
                        pkb.41)
         z.2   = 'g'^inv(x.75)
    
    122. gy    = x.68^(x.69*inv(x.70))
         pkb   = pkb.41
         signb = signb.42
         x     = inv((x.69*x.75))
         z     = x.68^inv((x.70*x.75))
         z.1   = verify(signb.42,
                        <'g'^inv((x.69*x.75)), x.68^(x.69*inv(x.70))>, pkb.41)
         z.2   = 'g'^inv((x.69*x.75))
    
    123. gy    = x.68^(x.69*inv(x.70))
         pkb   = pkb.41
         signb = signb.42
         x     = (x.70*x.75)
         z     = x.68^(x.69*x.75)
         z.1   = verify(signb.42, <'g'^(x.70*x.75), x.68^(x.69*inv(x.70))>,
                        pkb.41)
         z.2   = 'g'^(x.70*x.75)
    
    124. gy    = x.68^(x.69*inv(x.70))
         pkb   = pkb.41
         signb = signb.42
         x     = (x.70*x.75*inv(x.69))
         z     = x.68^x.75
         z.1   = verify(signb.42,
                        <'g'^(x.70*x.75*inv(x.69)), x.68^(x.69*inv(x.70))>, pkb.41)
         z.2   = 'g'^(x.70*x.75*inv(x.69))
    
    125. gy    = x.68^(x.69*inv(x.70))
         pkb   = pkb.41
         signb = signb.42
         x     = (x.70*inv((x.69*x.75)))
         z     = x.68^inv(x.75)
         z.1   = verify(signb.42,
                        <'g'^(x.70*inv((x.69*x.75))), x.68^(x.69*inv(x.70))>, pkb.41)
         z.2   = 'g'^(x.70*inv((x.69*x.75)))
    
    126. gy    = x.69^inv((x.70*x.71))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.70*x.76*inv(x.77))
         z     = x.69^(x.76*inv((x.71*x.77)))
         z.1   = verify(signb.43,
                        <'g'^(x.70*x.76*inv(x.77)), x.69^inv((x.70*x.71))>, pkb.42)
         z.2   = 'g'^(x.70*x.76*inv(x.77))
    
    127. gy    = x.69^(x.70*x.71)
         pkb   = pkb.42
         signb = signb.43
         x     = (x.76*inv((x.70*x.77)))
         z     = x.69^(x.71*x.76*inv(x.77))
         z.1   = verify(signb.43,
                        <'g'^(x.76*inv((x.70*x.77))), x.69^(x.70*x.71)>, pkb.42)
         z.2   = 'g'^(x.76*inv((x.70*x.77)))
    
    128. gy    = x.69^(x.70*x.71*inv(x.72))
         pkb   = pkb.42
         signb = signb.43
         x     = inv((x.71*x.77))
         z     = x.69^(x.70*inv((x.72*x.77)))
         z.1   = verify(signb.43,
                        <'g'^inv((x.71*x.77)), x.69^(x.70*x.71*inv(x.72))>, pkb.42)
         z.2   = 'g'^inv((x.71*x.77))
    
    129. gy    = x.69^(x.70*x.71*inv(x.72))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.72*x.77*inv(x.70))
         z     = x.69^(x.71*x.77)
         z.1   = verify(signb.43,
                        <'g'^(x.72*x.77*inv(x.70)), x.69^(x.70*x.71*inv(x.72))>, pkb.42)
         z.2   = 'g'^(x.72*x.77*inv(x.70))
    
    130. gy    = x.69^(x.70*x.71*inv(x.72))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.72*inv((x.70*x.77)))
         z     = x.69^(x.71*inv(x.77))
         z.1   = verify(signb.43,
                        <'g'^(x.72*inv((x.70*x.77))), x.69^(x.70*x.71*inv(x.72))>, pkb.42)
         z.2   = 'g'^(x.72*inv((x.70*x.77)))
    
    131. gy    = x.69^(x.70*inv(x.71))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.71*x.76*inv((x.70*x.77)))
         z     = x.69^(x.76*inv(x.77))
         z.1   = verify(signb.43,
                        <'g'^(x.71*x.76*inv((x.70*x.77))), x.69^(x.70*inv(x.71))>, pkb.42)
         z.2   = 'g'^(x.71*x.76*inv((x.70*x.77)))
    
    132. gy    = x.69^(x.70*inv(x.71))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.76*inv(x.77))
         z     = x.69^(x.70*x.76*inv((x.71*x.77)))
         z.1   = verify(signb.43,
                        <'g'^(x.76*inv(x.77)), x.69^(x.70*inv(x.71))>, pkb.42)
         z.2   = 'g'^(x.76*inv(x.77))
    
    133. gy    = x.69^(x.70*inv(x.71))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.76*inv((x.70*x.77)))
         z     = x.69^(x.76*inv((x.71*x.77)))
         z.1   = verify(signb.43,
                        <'g'^(x.76*inv((x.70*x.77))), x.69^(x.70*inv(x.71))>, pkb.42)
         z.2   = 'g'^(x.76*inv((x.70*x.77)))
    
    134. gy    = x.69^(x.70*inv((x.71*x.72)))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.71*x.77)
         z     = x.69^(x.70*x.77*inv(x.72))
         z.1   = verify(signb.43,
                        <'g'^(x.71*x.77), x.69^(x.70*inv((x.71*x.72)))>, pkb.42)
         z.2   = 'g'^(x.71*x.77)
    
    135. gy    = x.69^(x.70*inv((x.71*x.72)))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.71*x.77*inv(x.70))
         z     = x.69^(x.77*inv(x.72))
         z.1   = verify(signb.43,
                        <'g'^(x.71*x.77*inv(x.70)), x.69^(x.70*inv((x.71*x.72)))>, pkb.42)
         z.2   = 'g'^(x.71*x.77*inv(x.70))
    
    136. gy    = x.69^(x.70*inv((x.71*x.72)))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.71*inv(x.77))
         z     = x.69^(x.70*inv((x.72*x.77)))
         z.1   = verify(signb.43,
                        <'g'^(x.71*inv(x.77)), x.69^(x.70*inv((x.71*x.72)))>, pkb.42)
         z.2   = 'g'^(x.71*inv(x.77))
    
    137. gy    = x.69^(x.70*inv((x.71*x.72)))
         pkb   = pkb.42
         signb = signb.43
         x     = (x.71*inv((x.70*x.77)))
         z     = x.69^inv((x.72*x.77))
         z.1   = verify(signb.43,
                        <'g'^(x.71*inv((x.70*x.77))), x.69^(x.70*inv((x.71*x.72)))>,
                        pkb.42)
         z.2   = 'g'^(x.71*inv((x.70*x.77)))
    
    138. gy    = x.70^(x.71*x.72*inv(x.73))
         pkb   = pkb.43
         signb = signb.44
         x     = (x.73*x.78*inv((x.71*x.79)))
         z     = x.70^(x.72*x.78*inv(x.79))
         z.1   = verify(signb.44,
                        <'g'^(x.73*x.78*inv((x.71*x.79))), x.70^(x.71*x.72*inv(x.73))>,
                        pkb.43)
         z.2   = 'g'^(x.73*x.78*inv((x.71*x.79)))
    
    139. gy    = x.70^(x.71*x.72*inv(x.73))
         pkb   = pkb.43
         signb = signb.44
         x     = (x.78*inv((x.71*x.79)))
         z     = x.70^(x.72*x.78*inv((x.73*x.79)))
         z.1   = verify(signb.44,
                        <'g'^(x.78*inv((x.71*x.79))), x.70^(x.71*x.72*inv(x.73))>, pkb.43)
         z.2   = 'g'^(x.78*inv((x.71*x.79)))
    
    140. gy    = x.70^(x.71*x.72*inv((x.73*x.74)))
         pkb   = pkb.43
         signb = signb.44
         x     = (x.73*x.79*inv(x.71))
         z     = x.70^(x.72*x.79*inv(x.74))
         z.1   = verify(signb.44,
                        <'g'^(x.73*x.79*inv(x.71)), x.70^(x.71*x.72*inv((x.73*x.74)))>,
                        pkb.43)
         z.2   = 'g'^(x.73*x.79*inv(x.71))
    
    141. gy    = x.70^(x.71*x.72*inv((x.73*x.74)))
         pkb   = pkb.43
         signb = signb.44
         x     = (x.73*inv((x.71*x.79)))
         z     = x.70^(x.72*inv((x.74*x.79)))
         z.1   = verify(signb.44,
                        <'g'^(x.73*inv((x.71*x.79))), x.70^(x.71*x.72*inv((x.73*x.74)))>,
                        pkb.43)
         z.2   = 'g'^(x.73*inv((x.71*x.79)))
    
    142. gy    = x.70^(x.71*inv((x.72*x.73)))
         pkb   = pkb.43
         signb = signb.44
         x     = (x.72*x.78*inv(x.79))
         z     = x.70^(x.71*x.78*inv((x.73*x.79)))
         z.1   = verify(signb.44,
                        <'g'^(x.72*x.78*inv(x.79)), x.70^(x.71*inv((x.72*x.73)))>, pkb.43)
         z.2   = 'g'^(x.72*x.78*inv(x.79))
    
    143. gy    = x.70^(x.71*inv((x.72*x.73)))
         pkb   = pkb.43
         signb = signb.44
         x     = (x.72*x.78*inv((x.71*x.79)))
         z     = x.70^(x.78*inv((x.73*x.79)))
         z.1   = verify(signb.44,
                        <'g'^(x.72*x.78*inv((x.71*x.79))), x.70^(x.71*inv((x.72*x.73)))>,
                        pkb.43)
         z.2   = 'g'^(x.72*x.78*inv((x.71*x.79)))
    
    144. gy    = x.71^(x.72*x.73*inv((x.74*x.75)))
         pkb   = pkb.44
         signb = signb.45
         x     = (x.74*x.80*inv((x.72*x.81)))
         z     = x.71^(x.73*x.80*inv((x.75*x.81)))
         z.1   = verify(signb.45,
                        <'g'^(x.74*x.80*inv((x.72*x.81))), 
                         x.71^(x.72*x.73*inv((x.74*x.75)))>,
                        pkb.44)
         z.2   = 'g'^(x.74*x.80*inv((x.72*x.81)))
  */

restriction Equality:
  " x y #i. (Eq( x, y ) @ #i)  (x = y)"
  // safety formula

restriction Inequality:
  " x y #i. (Neq( x, y ) @ #i)  ((x = y))"
  // safety formula

restriction Noselftalk:
  " A x #i. (Commit( A, A, x ) @ #i)  ((#i = #i))"
  // safety formula

lemma executable:
  exists-trace
  " A B gx gy km #i #j.
    ((((Finish( B, A, 'R', gx, gy, km ) @ #i) 
       (Finish( A, B, 'I', gx, gy, km ) @ #j)) 
      (( R A.1 B.1 id1 id2 #i.1 #j.1.
          ((Init( R, A.1, id1 ) @ #i.1)  (Init( R, B.1, id2 ) @ #j.1)) 
          ((#i.1 = #j.1))))) 
     ((A = B))) 
    (( X #k. Reveal( X ) @ #k))"
/*
guarded formula characterizing all satisfying traces:
" A B gx gy km #i #j.
  (Finish( B, A, 'R', gx, gy, km ) @ #i) 
  (Finish( A, B, 'I', gx, gy, km ) @ #j)
 
  ( R A.1 B.1 id1 id2 #i.1 #j.1.
    (Init( R, A.1, id1 ) @ #i.1)  (Init( R, B.1, id2 ) @ #j.1)
   
    #i.1 = #j.1) 
  ((A = B)) 
  ( X #k. (Reveal( X ) @ #k)  )"
*/
simplify
solve( Finish( B, A, 'R', gx, gy, km ) @ #i )
  case B_2_send
  solve( St_B_2( A, B, idB, pka, kb, gx )  #i )
    case B_1_recv
    solve( Finish( $A, $A.1, 'I', gx, 'g'^~y, h(z) ) @ #j )
      case A_4_recv
      solve( St_A_4( $A, $A.1, idA, ka, pkb, x, 'g'^~y, h(z) )  #j )
        case A_3_send
        solve( !KU( sign(<'g'^~x, 'g'^~y>, ~sk.3) ) @ #vk.4 )
          case B_4_send
          solve( !KU( sign(<'g'^~y, 'g'^~x>, ~sk) ) @ #vk.12 )
            case A_3_send
            solve( !KU( mac(<'1', $A.1>, h('g'^(~x*~y))) ) @ #vk.7 )
              case B_4_send
              solve( !KU( 'g'^~y ) @ #vk.11 )
                case B_2_send
                solve( !KU( 'g'^~x ) @ #vk.9 )
                  case A_1_send
                  solve( !KU( pk(~sk.1) ) @ #vk.11 )
                    case B_4_send
                    solve( !KU( mac(<'0', $A>, h('g'^(~x*~y))) ) @ #vk.14 )
                      case A_3_send
                      solve( !KU( pk(~sk) ) @ #vk.15 )
                        case A_3_send
                        SOLVED // trace found
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma noninjectiveagreementINITIATOR:
  all-traces
  " a b t #i.
    ((Commit( a, b, <'I', 'R', t> ) @ #i) 
     ((( #r. Reveal( a ) @ #r)  ( #r. Reveal( b ) @ #r)))) 
    ( #j. Running( b, a, <'I', 'R', t> ) @ #j)"
/*
guarded formula characterizing all counter-examples:
" a b t #i.
  (Commit( a, b, <'I', 'R', t> ) @ #i)
 
  ( #r. (Reveal( a ) @ #r)  ) 
  ( #r. (Reveal( b ) @ #r)  ) 
  ( #j. (Running( b, a, <'I', 'R', t> ) @ #j)  )"
*/
simplify
solve( Commit( a, b, <'I', 'R', t> ) @ #i )
  case A_4_recv
  solve( St_A_4( a, b, idA, ka, pkb, x, gy, h(z) )  #i )
    case A_3_send
    solve( !KU( sign(<'g'^~x, gy>, ~sk.1) ) @ #vk.3 )
      case A_3_send
      solve( !KU( mac(<'1', $A.1>, h('g'^(~x*~x.1))) ) @ #vk.5 )
        case B_4_send
        solve( splitEqs(3) )
          case split
          solve( !KU( sign(<'g'^~y, 'g'^(~x*~x.1*inv(~y))>, ~sk.4)
                 ) @ #vk.12 )
            case c_sign
            solve( !KU( ~sk.4 ) @ #vk.18 )
              case Reveal_secret_key
              solve( !KU( 'g'^(~x*~x.1*inv(~y)) ) @ #vk.17 )
                case A_1_send_case_1
                by solve( !KU( ~x ) @ #vk.21 )
              next
                case A_1_send_case_2
                by solve( !KU( ~x.1 ) @ #vk.21 )
              next
                case c_exp
                by solve( !KU( ~x ) @ #vk.22 )
              qed
            qed
          qed
        qed
      next
        case c_mac
        solve( !KU( h('g'^(~x*~x.1)) ) @ #vk.10 )
          case c_h
          solve( !KU( 'g'^(~x*~x.1) ) @ #vk.12 )
            case A_1_send_case_1
            by solve( !KU( ~x ) @ #vk.13 )
          next
            case A_1_send_case_2
            by solve( !KU( ~x.1 ) @ #vk.13 )
          next
            case c_exp
            by solve( !KU( ~x ) @ #vk.15 )
          qed
        qed
      qed
    next
      case B_4_send
      solve( !KU( sign(<'g'^~y, 'g'^~x>, ~sk.2) ) @ #vk.11 )
        case A_3_send
        by contradiction /* from formulas */
      next
        case c_sign
        solve( !KU( ~sk.2 ) @ #vk.17 )
          case Reveal_secret_key
          solve( !KU( mac(<'0', $A.2>, h('g'^(~x*~y))) ) @ #vk.15 )
            case A_3_send
            solve( splitEqs(3) )
              case split_case_1
              by contradiction /* from formulas */
            next
              case split_case_2
              solve( !KU( 'g'^(~x*~y*inv(~x.1)) ) @ #vk.18 )
                case A_1_send
                by solve( !KU( ~y ) @ #vk.20 )
              next
                case B_2_send
                by solve( !KU( ~x ) @ #vk.20 )
              next
                case c_exp
                by solve( !KU( ~x ) @ #vk.21 )
              qed
            qed
          next
            case c_mac
            solve( !KU( h('g'^(~x*~y)) ) @ #vk.19 )
              case c_h
              solve( !KU( 'g'^(~x*~y) ) @ #vk.21 )
                case A_1_send
                by solve( !KU( ~y ) @ #vk.22 )
              next
                case B_2_send
                by solve( !KU( ~x ) @ #vk.22 )
              next
                case c_exp
                by solve( !KU( ~x ) @ #vk.24 )
              qed
            qed
          qed
        qed
      qed
    next
      case c_sign
      solve( !KU( ~sk.1 ) @ #vk.9 )
        case Reveal_secret_key
        by contradiction /* from formulas */
      qed
    qed
  qed
qed

lemma injectiveagreementINITIATOR:
  all-traces
  " a b t #i.
    ((Commit( a, b, <'I', 'R', t> ) @ #i) 
     ((( #r. Reveal( a ) @ #r)  ( #r. Reveal( b ) @ #r)))) 
    ( #j.
      (Running( b, a, <'I', 'R', t> ) @ #j) 
      (( a2 b2 #i2.
          (Commit( a2, b2, <'I', 'R', t> ) @ #i2)  ((#i2 = #i)))))"
/*
guarded formula characterizing all counter-examples:
" a b t #i.
  (Commit( a, b, <'I', 'R', t> ) @ #i)
 
  ( #r. (Reveal( a ) @ #r)  ) 
  ( #r. (Reveal( b ) @ #r)  ) 
  ( #j.
    (Running( b, a, <'I', 'R', t> ) @ #j)
   
     a2 b2 #i2.
     (Commit( a2, b2, <'I', 'R', t> ) @ #i2)  (#i2 = #i))"
*/
simplify
solve( Commit( a, b, <'I', 'R', t> ) @ #i )
  case A_4_recv
  solve( St_A_4( a, b, idA, ka, pkb, x, gy, h(z) )  #i )
    case A_3_send
    solve( !KU( sign(<'g'^~x, gy>, ~sk.1) ) @ #vk.3 )
      case A_3_send
      solve( !KU( mac(<'1', $A.1>, h('g'^(~x*~x.1))) ) @ #vk.5 )
        case B_4_send
        solve( splitEqs(3) )
          case split
          solve( !KU( sign(<'g'^~y, 'g'^(~x*~x.1*inv(~y))>, ~sk.4)
                 ) @ #vk.12 )
            case c_sign
            solve( !KU( ~sk.4 ) @ #vk.18 )
              case Reveal_secret_key
              solve( !KU( 'g'^(~x*~x.1*inv(~y)) ) @ #vk.17 )
                case A_1_send_case_1
                by solve( !KU( ~x ) @ #vk.21 )
              next
                case A_1_send_case_2
                by solve( !KU( ~x.1 ) @ #vk.21 )
              next
                case c_exp
                by solve( !KU( ~x ) @ #vk.22 )
              qed
            qed
          qed
        qed
      next
        case c_mac
        solve( !KU( h('g'^(~x*~x.1)) ) @ #vk.10 )
          case c_h
          solve( !KU( 'g'^(~x*~x.1) ) @ #vk.12 )
            case A_1_send_case_1
            by solve( !KU( ~x ) @ #vk.13 )
          next
            case A_1_send_case_2
            by solve( !KU( ~x.1 ) @ #vk.13 )
          next
            case c_exp
            by solve( !KU( ~x ) @ #vk.15 )
          qed
        qed
      qed
    next
      case B_4_send
      solve( !KU( sign(<'g'^~y, 'g'^~x>, ~sk.2) ) @ #vk.11 )
        case A_3_send
        solve( (#i2 < #i)   (#i < #i2) )
          case case_1
          solve( Commit( a2, b2, <'I', 'R', h('g'^(~x*~y))> ) @ #i2 )
            case A_4_recv
            solve( St_A_4( a2, b2, idA.1, ka, pkb, x.1, gy, h('g'^(~x*~y))
                   )  #i2 )
              case A_3_send
              solve( splitEqs(3) )
                case split_case_1
                by contradiction /* cyclic */
              next
                case split_case_2
                solve( !KU( sign(<'g'^~x.1, 'g'^(~x*~y*inv(~x.1))>, ~sk.3)
                       ) @ #vk.19 )
                  case c_sign
                  solve( !KU( ~sk.3 ) @ #vk.25 )
                    case Reveal_secret_key
                    solve( !KU( 'g'^(~x*~y*inv(~x.1)) ) @ #vk.24 )
                      case A_1_send
                      by solve( !KU( ~y ) @ #vk.28 )
                    next
                      case B_2_send
                      by solve( !KU( ~x ) @ #vk.28 )
                    next
                      case c_exp
                      by solve( !KU( ~x ) @ #vk.29 )
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case case_2
          solve( Commit( a2, b2, <'I', 'R', h('g'^(~x*~y))> ) @ #i2 )
            case A_4_recv
            solve( St_A_4( a2, b2, idA.1, ka, pkb, x.1, gy, h('g'^(~x*~y))
                   )  #i2 )
              case A_3_send
              solve( splitEqs(3) )
                case split_case_1
                by contradiction /* cyclic */
              next
                case split_case_2
                solve( !KU( sign(<'g'^~x.1, 'g'^(~x*~y*inv(~x.1))>, ~sk.3)
                       ) @ #vk.19 )
                  case c_sign
                  solve( !KU( ~sk.3 ) @ #vk.25 )
                    case Reveal_secret_key
                    solve( !KU( 'g'^(~x*~y*inv(~x.1)) ) @ #vk.24 )
                      case A_1_send
                      by solve( !KU( ~y ) @ #vk.28 )
                    next
                      case B_2_send
                      by solve( !KU( ~x ) @ #vk.28 )
                    next
                      case c_exp
                      by solve( !KU( ~x ) @ #vk.29 )
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( ~sk.2 ) @ #vk.17 )
          case Reveal_secret_key
          solve( !KU( mac(<'0', $A.2>, h('g'^(~x*~y))) ) @ #vk.15 )
            case A_3_send
            solve( splitEqs(3) )
              case split_case_1
              by contradiction /* from formulas */
            next
              case split_case_2
              solve( !KU( 'g'^(~x*~y*inv(~x.1)) ) @ #vk.18 )
                case A_1_send
                by solve( !KU( ~y ) @ #vk.20 )
              next
                case B_2_send
                by solve( !KU( ~x ) @ #vk.20 )
              next
                case c_exp
                by solve( !KU( ~x ) @ #vk.21 )
              qed
            qed
          next
            case c_mac
            solve( !KU( h('g'^(~x*~y)) ) @ #vk.19 )
              case c_h
              solve( !KU( 'g'^(~x*~y) ) @ #vk.21 )
                case A_1_send
                by solve( !KU( ~y ) @ #vk.22 )
              next
                case B_2_send
                by solve( !KU( ~x ) @ #vk.22 )
              next
                case c_exp
                by solve( !KU( ~x ) @ #vk.24 )
              qed
            qed
          qed
        qed
      qed
    next
      case c_sign
      solve( !KU( ~sk.1 ) @ #vk.9 )
        case Reveal_secret_key
        by contradiction /* from formulas */
      qed
    qed
  qed
qed

lemma noninjectiveagreementRESPONDER:
  all-traces
  " a b t #i.
    ((Commit( a, b, <'R', 'I', t> ) @ #i) 
     ((( #r. Reveal( a ) @ #r)  ( #r. Reveal( b ) @ #r)))) 
    ( #j. Running( b, a, <'R', 'I', t> ) @ #j)"
/*
guarded formula characterizing all counter-examples:
" a b t #i.
  (Commit( a, b, <'R', 'I', t> ) @ #i)
 
  ( #r. (Reveal( a ) @ #r)  ) 
  ( #r. (Reveal( b ) @ #r)  ) 
  ( #j. (Running( b, a, <'R', 'I', t> ) @ #j)  )"
*/
simplify
solve( Commit( a, b, <'R', 'I', t> ) @ #i )
  case B_3_recv
  solve( St_B_3( b, a, idB, pka, kb, gx, y, h(z) )  #i )
    case B_2_send
    solve( splitEqs(1) )
      case split_case_2
      solve( !KU( sign(<'g'^~y, 'g'^x>, ~sk) ) @ #vk.3 )
        case A_3_send
        solve( !KU( mac(<'0', $A>, h('g'^(~x*~y))) ) @ #vk.5 )
          case A_3_send
          solve( splitEqs(4) )
            case split_case_1
            solve( !KU( pk(~sk) ) @ #vk.6 )
              case A_3_send
              solve( splitEqs(7) )
                case split_case_2
                solve( !KU( 'g'^y.1 ) @ #vk.9 )
                  case A_1_send_case_1
                  solve( !KU( 'g'^~x ) @ #vk.8 )
                    case A_1_send
                    solve( !KU( 'g'^~y ) @ #vk.9 )
                      case B_2_send
                      SOLVED // trace found
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma injectiveagreementRESPONDER:
  all-traces
  " a b t #i.
    ((Commit( a, b, <'R', 'I', t> ) @ #i) 
     ((( #r. Reveal( a ) @ #r)  ( #r. Reveal( b ) @ #r)))) 
    ( #j.
      (Running( b, a, <'R', 'I', t> ) @ #j) 
      (( a2 b2 #i2.
          (Commit( a2, b2, <'R', 'I', t> ) @ #i2)  ((#i2 = #i)))))"
/*
guarded formula characterizing all counter-examples:
" a b t #i.
  (Commit( a, b, <'R', 'I', t> ) @ #i)
 
  ( #r. (Reveal( a ) @ #r)  ) 
  ( #r. (Reveal( b ) @ #r)  ) 
  ( #j.
    (Running( b, a, <'R', 'I', t> ) @ #j)
   
     a2 b2 #i2.
     (Commit( a2, b2, <'R', 'I', t> ) @ #i2)  (#i2 = #i))"
*/
simplify
solve( Commit( a, b, <'R', 'I', t> ) @ #i )
  case B_3_recv
  solve( St_B_3( b, a, idB, pka, kb, gx, y, h(z) )  #i )
    case B_2_send
    solve( splitEqs(1) )
      case split_case_2
      solve( !KU( sign(<'g'^~y, 'g'^x>, ~sk) ) @ #vk.3 )
        case A_3_send
        solve( !KU( mac(<'0', $A>, h('g'^(~x*~y))) ) @ #vk.5 )
          case A_3_send
          solve( splitEqs(4) )
            case split_case_1
            solve( !KU( pk(~sk) ) @ #vk.6 )
              case A_3_send
              solve( splitEqs(7) )
                case split_case_2
                solve( !KU( 'g'^y.1 ) @ #vk.9 )
                  case A_1_send_case_1
                  solve( !KU( 'g'^~x ) @ #vk.8 )
                    case A_1_send
                    solve( !KU( 'g'^~y ) @ #vk.9 )
                      case B_2_send
                      SOLVED // trace found
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma secrecy:
  all-traces
  " A B x #i.
    ((Secret( A, B, x ) @ #i) 
     ((( #r. Reveal( A ) @ #r)  ( #r. Reveal( B ) @ #r)))) 
    (( #j. K( x ) @ #j))"
/*
guarded formula characterizing all counter-examples:
" A B x #i.
  (Secret( A, B, x ) @ #i)
 
  ( #r. (Reveal( A ) @ #r)  ) 
  ( #r. (Reveal( B ) @ #r)  ) 
  ( #j. (K( x ) @ #j))"
*/
simplify
solve( Secret( A, B, x ) @ #i )
  case A_4_recv
  solve( St_A_4( A, B, idA, ka, pkb, x, gy, h(z) )  #i )
    case A_3_send
    solve( !KU( sign(<'g'^~x, gy>, ~sk.1) ) @ #vk.4 )
      case A_3_send
      solve( !KU( h('g'^(~x*~x.1)) ) @ #vk.1 )
        case c_h
        solve( !KU( 'g'^(~x*~x.1) ) @ #vk.10 )
          case A_1_send_case_1
          by solve( !KU( ~x ) @ #vk.11 )
        next
          case A_1_send_case_2
          by solve( !KU( ~x.1 ) @ #vk.11 )
        next
          case c_exp
          by solve( !KU( ~x ) @ #vk.13 )
        qed
      qed
    next
      case B_4_send
      solve( !KU( h('g'^(~x*~y)) ) @ #vk.1 )
        case c_h
        solve( !KU( sign(<'g'^~y, 'g'^~x>, ~sk.2) ) @ #vk.12 )
          case A_3_send
          solve( !KU( 'g'^(~x*~y) ) @ #vk.17 )
            case A_1_send
            by solve( !KU( ~y ) @ #vk.18 )
          next
            case B_2_send
            by solve( !KU( ~x ) @ #vk.18 )
          next
            case c_exp
            by solve( !KU( ~x ) @ #vk.20 )
          qed
        next
          case c_sign
          solve( !KU( ~sk.2 ) @ #vk.19 )
            case Reveal_secret_key
            solve( !KU( 'g'^(~x*~y) ) @ #vk.19 )
              case A_1_send
              by solve( !KU( ~y ) @ #vk.20 )
            next
              case B_2_send
              by solve( !KU( ~x ) @ #vk.20 )
            next
              case c_exp
              by solve( !KU( ~x ) @ #vk.22 )
            qed
          qed
        qed
      qed
    next
      case c_sign
      solve( !KU( ~sk.1 ) @ #vk.10 )
        case Reveal_secret_key
        by contradiction /* from formulas */
      qed
    qed
  qed
next
  case B_3_recv
  solve( St_B_3( A, B, idB, pka, kb, gx, y, h(z) )  #i )
    case B_2_send
    solve( splitEqs(1) )
      case split_case_1
      by contradiction /* from formulas */
    next
      case split_case_2
      solve( !KU( sign(<'g'^~y, 'g'^x>, ~sk) ) @ #vk.4 )
        case A_3_send
        solve( !KU( h('g'^(~x*~y)) ) @ #vk.1 )
          case c_h
          solve( !KU( 'g'^(~x*~y) ) @ #vk.10 )
            case A_1_send
            by solve( !KU( ~y ) @ #vk.11 )
          next
            case B_2_send
            by solve( !KU( ~x ) @ #vk.11 )
          next
            case c_exp
            by solve( !KU( ~x ) @ #vk.13 )
          qed
        qed
      next
        case B_4_send
        solve( !KU( h('g'^(~y*~y.1)) ) @ #vk.1 )
          case c_h
          solve( !KU( sign(<'g'^~y, 'g'^~y.1>, ~sk.2) ) @ #vk.12 )
            case B_4_send
            by contradiction /* cyclic */
          next
            case c_sign
            solve( !KU( ~sk.2 ) @ #vk.19 )
              case Reveal_secret_key
              solve( !KU( 'g'^(~y*~y.1) ) @ #vk.19 )
                case B_2_send_case_1
                by solve( !KU( ~y ) @ #vk.20 )
              next
                case B_2_send_case_2
                by solve( !KU( ~y.1 ) @ #vk.20 )
              next
                case c_exp
                by solve( !KU( ~y ) @ #vk.22 )
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( ~sk ) @ #vk.10 )
          case Reveal_secret_key
          by contradiction /* from formulas */
        qed
      qed
    qed
  qed
qed



















/* All wellformedness checks were successful. */

/*
Generated from:
Tamarin version 1.8.0
Maude version 3.3.1
Git revision: UNKNOWN, branch: UNKNOWN
Compiled at: 2024-03-03 10:40:56.227406742 UTC
*/

end